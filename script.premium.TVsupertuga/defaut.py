exec("import re;import base64");exec(base64.b64decode("IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQojIC0qLSBjb2Rpbmc6IFVURi04IC0qLQ0KIyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQ0KIyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KIyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcg0KIyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KIw0KIyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCiMgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCiMgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQ0KIyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLg0KIw0KIyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQ0KIyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCg0KDQojIyMjIyMjIyMjIyMjI0JJQkxJT1RFQ0FTIEEgSU1QT1JUQVIgRSBERUZJTklDT0VTIyMjIyMjIyMjIyMjIyMjIyMjIyMNCmltcG9ydCB1cmxsaWIsdXJsbGliMixzeXMscmUseGJtY3BsdWdpbix4Ym1jZ3VpLHhibWNhZGRvbix4Ym1jLG9zLGpzb24sZ2xvYix0aHJlYWRpbmcsZ3ppcCx4Ym1jdmZzLGNvb2tpZWxpYixwcHJpbnQsZGF0ZXRpbWUsdGhyZWFkLHRpbWUsdXJscGFyc2UsYmFzZTY0LHBsdWdpbnRvb2xzLGNhbGVuZGFyDQppbXBvcnQgeG1sLmV0cmVlLkVsZW1lbnRUcmVlIGFzIEVUDQppbXBvcnQgZmlsZVV0aWxzIGFzIGZ1DQoNCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgY29tbW9uDQpmcm9tIHVybGxpYjIgaW1wb3J0IFJlcXVlc3QsIHVybG9wZW4NCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGUNCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwDQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERvd25sb2FkZXIgI0VuZW45MiBjbGFzcw0KZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBQbGF5ZXINCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgVFZBcmNoaXZlDQpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IE5ldA0KZnJvbSB0MG1tMC5jb21tb24uYWRkb24gaW1wb3J0IEFkZG9uDQpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IEh0dHBSZXNwb25zZQ0KZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBVUkxSZXNvbHZlck1lZGlhDQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IFRyYWt0DQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERhdGFiYXNlDQpmcm9tIHVuaWNvZGVkYXRhIGltcG9ydCBub3JtYWxpemUNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBDT05TVEFOVEVTICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCmdsb2JhbCBnX3RpbWVyDQpnbG9iYWwgdGVsZXZpc2lvb25pbGluaw0KZ2xvYmFsIGZpbG1pbGluaw0KZ2xvYmFsIGFuZG1lbGluaw0KZ2xvYmFsIHV1ZW5kdXNsaW5rDQpnbG9iYWwgdXVlbmR1c2VkDQpnbG9iYWwgdmFuZW1hbHVraw0KZ2xvYmFsIHZlcnNpb24NCmdsb2JhbCBtb2RlDQoNCnJlbG9hZChzeXMpDQpzeXMuc2V0ZGVmYXVsdGVuY29kaW5nKCd1dGY4JykNCkFkZG9uVGl0bGUgPSAiVFZzdXBlcnR1Z2EgUHJlbWl1bSINCm1vZGUgPSAzMzMzDQp2ZXJzaW9uID0gIiINCmthc3V0YWphbmltaSA9ICIiDQpzYWxhc29uYSA9ICIiDQpsZWhla3lsZyA9ICIiDQp2YW5lbWFrb29kID0gIiINCnZhbmVtYWx1a2sgPSAiIg0KdGVsZXZpc2lvb25pbGluayA9ICIiDQpmaWxtaWxpbmsgPSAiIg0KYW5kbWVsaW5rID0gIiINCg0KX0xJSUxMXyA9ICJhSFIwY0RvdkwybHdkSFp3WWk1elpXeG1hWEF1Ym1WME9qZ3dNREE9Ig0KX19BRERPTl9JRF9fCT0geGJtY2FkZG9uLkFkZG9uKCkuZ2V0QWRkb25JbmZvKCJpZCIpDQpfX0FERE9OX18JPSB4Ym1jYWRkb24uQWRkb24oX19BRERPTl9JRF9fKQ0KX19BRERPTlZFUlNJT05fXyA9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3ZlcnNpb24nKQ0KX19BRERPTl9GT0xERVJfXwk9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3BhdGgnKQ0KX19TRVRUSU5HX18JPSB4Ym1jYWRkb24uQWRkb24oKS5nZXRTZXR0aW5nDQpfX0FSVF9GT0xERVJfXwk9IF9fQURET05fRk9MREVSX18gKyAnL3Jlc291cmNlcy9pbWcvJw0KX19TS0lOX18gPSAndjInDQpfX0ZBTkFSVF9fID0gb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvLnBuZycpDQpfX1BBU1RBX0RBRE9TX18gPSBBZGRvbihfX0FERE9OX0lEX18pLmdldF9wcm9maWxlKCkuZGVjb2RlKCJ1dGYtOCIpDQpfX1BBU1RBX0ZJTE1FU19fID0geGJtYy50cmFuc2xhdGVQYXRoKF9fQURET05fXy5nZXRTZXR0aW5nKCdiaWJsaW90ZWNhRmlsbWVzJykpDQpfX1BBU1RBX1NFUklFU19fID0geGJtYy50cmFuc2xhdGVQYXRoKF9fQURET05fXy5nZXRTZXR0aW5nKCdiaWJsaW90ZWNhU2VyaWVzJykpDQpfX0NPT0tJRV9GSUxFX18gPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vdXNlcmRhdGEvYWRkb25fZGF0YS9zY3JpcHQucHJlbWl1bS5UVnN1cGVydHVnYS8nKS5kZWNvZGUoJ3V0Zi04JyksICdjb29raWUudHZzdXBlcnR1Z2FwcmVtaXVtJykNCl9fQVBJX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDIxd1lYQnBMbTFzTHc9PScpDQpfX0FQSV9TSVRFX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDIxd1lYQnBMbTFzTDJGd2FTOD0nKQ0KX19TSVRFQWRkb25fXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMM2QzZHk1d1kzUmxZMnR6WlhKMkxtTnZiUzlIY25Wd2IwdHZaR2t2UVdSa2IyNHYnKQ0KX0lDT05fID0gb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb24ucG5nJykNCl9fSEVBREVSU19fID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LCovKjtxPTAuOCd9DQpoZWFkZXJzID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0LUNoYXJzZXQnOiAndXRmLTg7cT0wLjcsKjtxPTAuNycsICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9DQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojCQkJCQkJCSAgSW5pY2lhciBBZGRvbgkJCQkJCQkJCQkgICMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCmRlZiBfX0FMRVJUQV9fKHRleHQxPSIiLHRleHQyPSIiLHRleHQzPSIiKToNCglpZiB0ZXh0Mz09IiI6IHhibWNndWkuRGlhbG9nKCkub2sodGV4dDEsdGV4dDIpDQoJZWxpZiB0ZXh0Mj09IiI6IHhibWNndWkuRGlhbG9nKCkub2soIiIsdGV4dDEpDQoJZWxzZTogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0Mix0ZXh0MykNCg0KZGVmIGNyaWFyTWVudShwYWksbm9tZSxsb2dvLHVybCx0aXBvLGZhbmFydCk6DQoJbWVudXMgPSB7DQoJCQknbm9tZSc6ICcnLA0KCQkJJ2xvZ28nOiAnJywNCgkJCSd1cmwnOiAnJywNCgkJCSd0aXBvJzogJycsDQoJCQknZmFuYXJ0JzogJycNCgkJCX0NCgltZW51c1snbm9tZSddID0gbm9tZQ0KCW1lbnVzWydsb2dvJ10gPSBsb2dvDQoJbWVudXNbJ3VybCddID0gdXJsDQoJbWVudXNbJ3RpcG8nXSA9IHRpcG8NCgltZW51c1snZmFuYXJ0J10gPSBmYW5hcnQNCglwYWkuYXBwZW5kKG1lbnVzKQ0KCQ0KZGVmIG1lbnUoKToNCglpZiAobm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykgb3Igbm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKToNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnUHJlY2lzYSBkZSBkZWZpbmlyIG8gc2V1IFV0aWxpemFkb3IgZSBTZW5oYScpDQoJCWFicmlyRGVmaW5pbmNvZXMoKQ0KCQkNCgllbHNlOgkNCgkJY2hlY2tfbG9naW4gPSBsb2dpbihiYXNlNjQuYjY0ZGVjb2RlKF9MSUlMTF8pKQ0KCQlpZiBjaGVja19sb2dpblsndXNlciddWyd1c2VybmFtZSddICE9ICcnOg0KCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZXN0YWRvJ10gPT0gJ0V4cGlyZWQnOg0KCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Egc3VhIGNvbnRhIGVzdMOhIEV4cGlyYWRhLiBQb3IgZmF2b3IgZmHDp2EgYSBzdWEgUmVub3Zhw6fDo28gb3UgUmVhY3RpdmHDp8Ojby4nKQkJDQoJCQllbHNlOg0KCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3RyaWFsJ10gPT0gJ1llcycgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSAhPSAnTmV2ZXInOg0KCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIGNvbnRhIMOpIHVtYSBjb250YSBkZSBUZXN0ZS4gQXDDs3MgbyB0ZXN0ZSBlIGdvc3RhciBmYcOnYSBhIHN1YSBBcXVpc2nDp8Ojby4nKQ0KCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSAhPSAnTmV2ZXInIGFuZCBjaGVja19sb2dpblsndXNlciddWyd0cmlhbCddID09ICdObyc6DQoJCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSA9PSAnMCcgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3RyaWFsJ10gIT0gJ1llcyc6DQoJCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIHN1YSBjb250YSBleHBpcmEgSG9qZS4gRmHDp2EgasOhIGEgc3VhIFJlbm92YcOnw6NvLicpDQoJCQkJCWVsc2U6DQoJCQkJCQlpZiBpbnQoY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddKSA8IDUgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSA+IDA6DQoJCQkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXhwaXJhIGRhcXVpIGEgJytzdHIoY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddKSsgJyBkaWFzLiBGYcOnYSBqw6EgYSBzdWEgUmVub3Zhw6fDo28uJykNCgkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIk1pbmhhIENvbnRhIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxiYXNlNjQuYjY0ZGVjb2RlKF9MSUlMTF8pLCJjb250YSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSkNCgkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIlZlciBUViIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSxiYXNlNjQuYjY0ZGVjb2RlKF9MSUlMTF8pLCJ0diIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQ0KCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiVsOtZGVvIENsdWJlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3ZpZC5wbmcnKSxiYXNlNjQuYjY0ZGVjb2RlKF9MSUlMTF8pLCJmaWxtZXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJykpDQoJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJUViBBcmNoaXZlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2X2FyYy5wbmcnKSxiYXNlNjQuYjY0ZGVjb2RlKF9MSUlMTF8pLCJ0dmFyY2hpdmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190dl9hcmMucG5nJykpDQoJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJDb25maWd1cmHDp8O1ZXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fZGVmLnBuZycpLCJjb25maWd1cmFyIiwiY29uZmlndXJhciIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkNCgkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkxpbXBhciBDYWNoZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksImxpbXBhcmNhY2hlIiwibGltcGFyY2FjaGUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpDQoJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJMaW1wYXIgVHVkbyBHcmF2YWRvIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwibGltcGFydHVkbyIsImxpbXBhcnR1ZG8iLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpDQoJCQkJDQoJCQkJTWVudV9pbmljaWFsKGNoZWNrX2xvZ2luLEZhbHNlLCcnKQ0KCQkJdmlzdGFfbWVudSgpDQoJCWVsc2U6DQoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdVdGlsaXphZG9yIG91IHNlbmhhIEluY29ycmVjdG9zLiBBbHRlcmUgZSB0ZW50ZSBub3ZhbWVudGUuJykNCgkJCWFkZERpcignQWx0ZXJhciBEZWZpbmnDp8O1ZXMnLCAndXJsJywgNSwgJ01pbmlhdHVyYScsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fZGVmLnBuZycpLCcnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fZGVmLnBuZycpKQ0KCQkJYWRkRGlyKCdFbnRyYXIgbm92YW1lbnRlJywgJ3VybCcsIE5vbmUsICdNaW5pYXR1cmEnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fbGltLnBuZycpKQ0KCQkJdmlzdGFfbWVudSgpDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojCQkJCQkJCSAgTG9naW4gQWRkb24JCQkJCQkJCQkJICAjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQpkZWYgbG9naW4odXJsKToNCglpbmZvcm1hY29lcyA9IHsNCgkJJ3VzZXInIDogew0KCQkJJ3VzZXJuYW1lJzogJycsDQoJCQkncGFzc3dvcmQnOiAnJywNCgkJCSdlc3RhZG8nOiAnJywNCgkJCSdkYXRhJzogJycsDQoJCQkndHJpYWwnOiAnJywNCgkJCSdsaXN0YSc6ICcnLA0KCQkJJ2NvbmVjY29lcyc6ICcnDQoJCQkNCgkJfSwNCgkJJ21lbnVzJzogW10NCgl9ICMgDQoJYW5kbWVsaW5rID0gdXJsKycvcGxheWVyX2FwaS5waHA/bW9kZT11c2VyX2luZm8mdXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKQ0KCWFuZG1lZCA9IGdyYWJfZXBnKGFuZG1lbGluaykNCglpZiBhbmRtZWQgIT0gTm9uZToNCgkJa2FzdXRhamFBbmRtZWQgPSBhbmRtZWRbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0NCgkJa2FzdXRhamFBbmRtZWQyID0gYW5kbWVkW3N5bmNfZGF0YSgiYzJWeWRtVnlYMmx1Wm04PSIpXQ0KCQlzZWlzID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImMzUmhkSFZ6IildDQoJCWFlZ3ViID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJaWGh3WDJSaGRHVT0iKV0NCgkJaWYgYWVndWI6DQoJCQlhZWd1YiA9IGRhdGUuZnJvbXRpbWVzdGFtcChpbnQoYWVndWIpKS5zdHJmdGltZSgiJVktJW0tJWQiKQ0KCQkJZWFlYWVuID0ga2FzdXRhamFBbmRtZWQyW3N5bmNfZGF0YSgiZEdsdFpWOXViM2M9IildDQoJCQkNCgkJCXZpZXdTdGFydERhdGUgPSBkYXRldGltZS5kYXRldGltZS5ub3coKS5zdHJmdGltZSgiJVktJW0tJWQiKQ0KCQkJDQoJCQlmb3JtYXQgPSAiJVktJW0tJWQiDQoJCQkNCgkJCXRyeToNCgkJCQlob2plMSA9IGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpDQoJCQlleGNlcHQgVHlwZUVycm9yOg0KCQkJCWhvamUxID0gZGF0ZXRpbWUuZGF0ZXRpbWUoKih0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpWzA6Nl0pKQ0KCQkJDQoJCQl0cnk6DQoJCQkJaG9qZTIgPSBkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh2aWV3U3RhcnREYXRlLCBmb3JtYXQpDQoJCQlleGNlcHQgVHlwZUVycm9yOg0KCQkJCWhvamUyID0gZGF0ZXRpbWUuZGF0ZXRpbWUoKih0aW1lLnN0cnB0aW1lKHZpZXdTdGFydERhdGUsIGZvcm1hdClbMDo2XSkpDQoJCQkNCgkJCWFlZ3ViID0gc3RyKGFicygoaG9qZTEtaG9qZTIpLmRheXMpKQ0KCQllbHNlOg0KCQkJYWVndWIgPSB2b2RfY2hhbm5lbHMoIlRtVjJaWEk9IikgDQoJCXJhYmJpdHMgPSBrYXN1dGFqYUFuZG1lZFt2b2RfY2hhbm5lbHMoImFYTmZkSEpwWVd3PSIpXQ0KCQlpZiByYWJiaXRzID09ICIwIjoNCgkJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIlRtOD0iKQ0KCQllbHNlOg0KCQkJcmFiYml0cyA9IHN5bmNfZGF0YSgiV1dWeiIpDQoJCWxlYXZlbWVhbG9uZSA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJiV0Y0WDJOdmJtNWxZM1JwYjI1eiIpXQ0KCQlwb2xhcmJlYXJzID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJkWE5sY201aGJXVT0iKV0NCgkJDQoJCWlmKHBvbGFyYmVhcnMgIT0gJycpOg0KCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndXNlcm5hbWUnXSA9ICJbQ09MT1IgPSB3aGl0ZV1VdGlsaXphZG9yOiBbL0NPTE9SXSIrcG9sYXJiZWFycw0KCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnZXN0YWRvJ10gPSBzZWlzDQoJCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSBhZWd1Yg0KCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndHJpYWwnXSA9IHJhYmJpdHMNCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2NvbmVjY29lcyddID0gIltDT0xPUiA9IHdoaXRlXU1heGltbyBkZSBDb25uZWM6IFsvQ09MT1JdIitsZWF2ZW1lYWxvbmUNCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2xpc3RhJ10gPSB1cmwNCgkNCglyZXR1cm4gaW5mb3JtYWNvZXMNCg0KZGVmIGxvZ2luMigpOg0KCXJlc3VsdGFkbyA9IEZhbHNlDQoJdHJ5Og0KCQlwb3N0ID0geyd1c2VybmFtZSc6IF9fQURET05fXy5nZXRTZXR0aW5nKCdlbWFpbCcpLCAncGFzc3dvcmQnOiBfX0FERE9OX18uZ2V0U2V0dGluZygncGFzc3dvcmQnKSwnZ3JhbnRfdHlwZSc6ICdwYXNzd29yZCcsICdjbGllbnRfaWQnOiAna29kaScsICdjbGllbnRfc2VjcmV0JzoncHlSbW1LSzNjYmpvdW9ETUxYTnR0MmVHa3lUVEFHJyB9DQoJCQ0KCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydsb2dpbicsIHBvc3Q9anNvbi5kdW1wcyhwb3N0KSwgaGVhZGVyPWhlYWRlcnMpDQoJCQ0KCQlpZiByZXN1bHRhZG8gPT0gJ0ROUyc6DQoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBhZGRvbi4nKQ0KCQkJcmV0dXJuIEZhbHNlDQoJCQ0KCQlyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykNCgkJI2NvbG9jYXIgbyBsb2dnZWRpbg0KCQl0b2tlbiA9IHJlc3VsdGFkb1snYWNjZXNzX3Rva2VuJ10NCgkJcmVmcmVzaCA9IHJlc3VsdGFkb1sncmVmcmVzaF90b2tlbiddDQoJCWhlYWRlcnNOID0gaGVhZGVycw0KCQloZWFkZXJzTlsnQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSB0b2tlbg0KCQkNCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnbWUnLCBoZWFkZXI9aGVhZGVyc04pDQoJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQ0KCQl0cnk6DQoJCQl1c2VybmFtZSA9IHJlc3VsdGFkb1sndXNlcm5hbWUnXS5kZWNvZGUoJ3V0Zi04JykNCgkJZXhjZXB0Og0KCQkJdXNlcm5hbWUgPSByZXN1bHRhZG9bJ3VzZXJuYW1lJ10uZW5jb2RlKCd1dGYtOCcpDQoJCQ0KCQlpZiByZXN1bHRhZG9bJ2VtYWlsJ10gPT0gX19BRERPTl9fLmdldFNldHRpbmcoJ2VtYWlsJyk6DQoJCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScsIHRva2VuKQ0KCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3JlZnJlc2hNcnBpcmFjeScsIHJlZnJlc2gpDQoJCQlfX0FERE9OX18uc2V0U2V0dGluZygnbG9nZ2VkaW4nLCB1c2VybmFtZSkNCgkJCXJldHVybiBUcnVlDQoJZXhjZXB0Og0KCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGZvaSBwb3Nzw612ZWwgYWJyaXIgYSBww6FnaW5hLiBQb3IgZmF2b3IgdGVudGUgbm92YW1lbnRlLicpDQoJCXJldHVybiBGYWxzZQ0KDQpkZWYgTWVudV9pbmljaWFsKG1lbixidWlsZCx0aXBvKToNCglfbm9tZXVzZXIgPSBtZW5bJ3VzZXInXVsndXNlcm5hbWUnXQ0KCWZvciBtZW51IGluIG1lblsnbWVudXMnXToNCgkJbm9tZSA9IG1lbnVbJ25vbWUnXQ0KCQlsb2dvID0gbWVudVsnbG9nbyddDQoJCWxpbmsgPSBtZW51Wyd1cmwnXQ0KCQl0aXBvID0gbWVudVsndGlwbyddDQoJCWZhbmFydCA9IG1lbnVbJ2ZhbmFydCddDQoJCQ0KCQlpZiB0aXBvID09ICdjb250YScgOg0KCQkJYWRkRGlyKG5vbWUsbGluaywyLCdNaW5pYXR1cmEnLGxvZ28sdGlwbyxmYW5hcnQpDQoJCWVsaWYodGlwbyA9PSAndHYnKToNCgkJCWFkZERpcihub21lLGxpbmssMywnTWluaWF0dXJhJyxsb2dvLHRpcG8sZmFuYXJ0KQ0KCQllbGlmKHRpcG8gPT0gJ2ZpbG1lcycpOg0KCQkJYWRkRGlyKG5vbWUsbGluaywxLCdNaW5pYXR1cmEnLGxvZ28sdGlwbyxmYW5hcnQpDQoJCWVsaWYodGlwbyA9PSAnY29uZmlndXJhcicpOg0KCQkJYWRkRGlyKG5vbWUsbGluayw1LCdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkNCgkJZWxpZiB0aXBvID09ICd0dmFyY2hpdmUnOg0KCQkJYWRkRGlyKG5vbWUsbGluayw2LCdNaW5pYXR1cmEnLGxvZ28sJycsZmFuYXJ0KQkNCgkJZWxpZih0aXBvID09ICdsaW1wYXJjYWNoZScpOg0KCQkJYWRkRGlyKG5vbWUsIGxpbmssIDEzLCAnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpDQoJCWVsaWYodGlwbyA9PSAnbGltcGFydHVkbycpOg0KCQkJYWRkRGlyKG5vbWUsIGxpbmssIDE0LCAnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpDQoJCQ0KCXhibWMuZXhlY3V0ZWJ1aWx0aW4oJ05vdGlmaWNhdGlvbiglcywgJXMsICVpLCAlcyknJShBZGRvblRpdGxlLF9ub21ldXNlciwgODAwMCwgX0lDT05fKSkNCgl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpDQoNCmRlZiBhYnJpclZpZGVvQ2x1YmUodXJsKToNCglhZGREaXIoJ0ZpbG1lcycsdXJsLDIxLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJ0ZpbG1lJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG8ucG5nJykpCQkJCQkNCglhZGREaXIoJ1PDqXJpZXMnLHVybCwyMCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLCdTZXJpZScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvLnBuZycpKQ0KCSNhZGREaXIoJ0FuaW1lcycsdXJsLDI0LCdNaW5pYXR1cmEnLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvYW5pbWUucG5nJywnQW5pbWUnLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvc2VyaWVzX2ZhbmFydC5wbmcnKQ0KCWFkZERpcignUGVzcXVpc2EnLF9fQVBJX1NJVEVfXywxMjAsJ0xpc3RhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksJ3Blc3F1aXNhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG8ucG5nJykpDQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMJCQkJCQkJICBBYnJpciBJbmZvIENvbnRhCQkJCQkJCQkJICAjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQpkZWYgQWJyaXJfQ29udGEodXJsKToNCglhbmRtZWxpbmsgPSB1cmwrJy9wYW5lbF9hcGkucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikNCglleGVjdXRlX2FpbmZvKGFuZG1lbGluaykNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojCQkJCQkJCQkJCQkJCUFicmlyIEluZm8gVFZTCQkJCQkJCQkJCQkgIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCmRlZiBhYnJpbTN1KHVybCk6DQoJdmVyc2lvbiA9IF9fQURET05WRVJTSU9OX18NCglrYXN1dGFqYW5pbWk9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKQ0KCXNhbGFzb25hPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpDQoJbGVoZWt5bGc9dXJsDQoJdmFuZW1ha29vZD1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvcyIpDQoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQ0KCQ0KCXRlbGV2aXNpb29uaWxpbmsgPSB1cmwrJy9lbmlnbWEyLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpKycmdHlwZT1nZXRfbGl2ZV9jYXRlZ29yaWVzJw0KCXNlY3VyaXR5X2NoZWNrKHRlbGV2aXNpb29uaWxpbmspDQoNCmRlZiBzZWN1cml0eV9jaGVjayh1cmwpOg0KCXJlcXVlc3QgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCBoZWFkZXJzPXsiQWNjZXB0IiA6ICJhcHBsaWNhdGlvbi94bWwifSkNCgl1ID0gdXJsbGliMi51cmxvcGVuKHJlcXVlc3QpDQoJdHJlZSA9IEVULnBhcnNlKHUpDQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQ0KCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOg0KCQlrYW5hbGluaW1pID0gY2hhbm5lbC5maW5kKCJ0aXRsZSIpLnRleHQNCgkJa2FuYWxpbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoa2FuYWxpbmltaSkNCgkJa2F0ZWdvb3JpYWxpbmsgPSBjaGFubmVsLmZpbmQoInBsYXlsaXN0X3VybCIpLnRleHQNCgkJDQoJCWFkZERpcihrYW5hbGluaW1pLGthdGVnb29yaWFsaW5rLDgsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpDQoJDQoJdmlzdGFfR3J1cG9zKCkNCg0KZGVmIGRldGVjdF9tb2RpZmljYXRpb24odXJsKToNCglmaWxtaWxpbmsgPSB1cmwrJy9lbmlnbWEyLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpKycmdHlwZT1nZXRfdm9kX2NhdGVnb3JpZXMnDQoJcmVxdWVzdCA9IHVybGxpYjIuUmVxdWVzdChmaWxtaWxpbmssIGhlYWRlcnM9eyJBY2NlcHQiIDogImFwcGxpY2F0aW9uL3htbCJ9KQ0KCXUgPSB1cmxsaWIyLnVybG9wZW4ocmVxdWVzdCkNCgl0cmVlID0gRVQucGFyc2UodSkNCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpDQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKCJjaGFubmVsIik6DQoJCWZpbG1pbmltaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0DQoJCWZpbG1pbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoZmlsbWluaW1pKQ0KCQlrYXRlZ29vcmlhbGluayA9IGNoYW5uZWwuZmluZCgicGxheWxpc3RfdXJsIikudGV4dA0KCQkNCgkJYWRkRGlyKGZpbG1pbmltaSxrYXRlZ29vcmlhbGluayw5LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdmlkLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJykpDQoJDQoJdmlzdGFfR3J1cG9zKCkNCg0KZGVmIHN0cmVhbV92aWRlbyhuYW1lLHVybCxpbWFnZSk6DQoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQ0KCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOg0KCQl2YW5lbWFfbHVrayhuYW1lKQ0KCXJlcXVlc3QgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCBoZWFkZXJzPXsiQWNjZXB0IiA6ICJhcHBsaWNhdGlvbi94bWwifSkNCgl1ID0gdXJsbGliMi51cmxvcGVuKHJlcXVlc3QpDQoJdHJlZSA9IEVULnBhcnNlKHUpDQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQ0KCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbChzeW5jX2RhdGEoIlkyaGhibTVsYkE9PSIpKToNCgkJa2FuYWxpbmltaSA9IGNoYW5uZWwuZmluZChnZXRfbGl2ZSgiZEdsMGJHVT0iKSkudGV4dA0KCQlrYW5hbGluaW1pID0gYmFzZTY0LmI2NGRlY29kZShrYW5hbGluaW1pKQ0KCQlrYW5hbGluaW1pID0ga2FuYWxpbmltaS5wYXJ0aXRpb24oIlsiKQ0KCQlzdHJpaW1pbGluayA9IGNoYW5uZWwuZmluZChnZXRfbGl2ZSgiYzNSeVpXRnRYM1Z5YkE9PSIpKS50ZXh0DQoJCXBpbHQgPSBjaGFubmVsLmZpbmQoImRlc2NfaW1hZ2UiKS50ZXh0DQoJCWthdmEgPSBrYW5hbGluaW1pWzFdK2thbmFsaW5pbWlbMl0NCgkJa2F2YSA9IGthdmEucGFydGl0aW9uKCJdIikNCgkJa2F2YSA9IGthdmFbMl0NCgkJa2F2YSA9IGthdmEucGFydGl0aW9uKCIJIikNCgkJa2F2YSA9IGthdmFbMl0NCgkJc2hvdSA9IGdldF9saXZlKCJXME5QVEU5U0lIZG9hWFJsWFNWeklGc3ZRMDlNVDFKZCIpJShrYW5hbGluaW1pWzBdKStrYXZhDQoJCWtpcmplbGR1cyA9IGNoYW5uZWwuZmluZCgiZGVzY3JpcHRpb24iKS50ZXh0DQoJCWlmIGtpcmplbGR1czoNCgkJCWtpcmplbGR1cyA9IGJhc2U2NC5iNjRkZWNvZGUoa2lyamVsZHVzKQ0KCQkJbnl5ZCA9IGtpcmplbGR1cy5wYXJ0aXRpb24oIigiKQ0KCQkJbnl5ZCA9ICJBZ29yYTogIitueXlkWzBdDQoJCQlqYXJnbWluZSA9IGtpcmplbGR1cy5wYXJ0aXRpb24oIilcbiIpDQoJCQlqYXJnbWluZSA9IGphcmdtaW5lWzJdLnBhcnRpdGlvbigiKCIpDQoJCQlqYXJnbWluZSA9ICJBIHNlZ3VpcjogIitqYXJnbWluZVswXQ0KCQkJa29ra3UgPSBueXlkK2phcmdtaW5lDQoJCWVsc2U6DQoJCQlrb2trdSA9ICIiDQoJCWlmIHBpbHQ6DQoJCQlhZGRMaW5rQ2FuYWxMaXN0YShzaG91LHN0cmlpbWlsaW5rLHBpbHQsa29ra3Usb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQ0KCQllbHNlOg0KCQkJYWRkTGlua0NhbmFsTGlzdGEoc2hvdSxzdHJpaW1pbGluayxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLGtva2t1LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSkNCgkNCgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSAsImVwaXNvZGVzIikNCgl2aXN0YV9DYW5haXMoKQ0KDQpkZWYgZ2V0X215YWNjb3VudChuYW1lLHVybCxpbWFnZSk6DQoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQ0KCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOg0KCQl2YW5lbWFfbHVrayhuYW1lKQ0KCQ0KCXJlcXVlc3QgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCBoZWFkZXJzPXsiQWNjZXB0IiA6ICJhcHBsaWNhdGlvbi94bWwifSkNCgl1ID0gdXJsbGliMi51cmxvcGVuKHJlcXVlc3QpDQoJdHJlZSA9IEVULnBhcnNlKHUpDQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQ0KCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOg0KCQlwZWFsa2lyaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0DQoJCXBlYWxraXJpID0gYmFzZTY0LmI2NGRlY29kZShwZWFsa2lyaSkNCgkJcGVhbGtpcmkgPSBwZWFsa2lyaS5lbmNvZGUoInV0Zi04IikNCgkJc3RyaWltaWxpbmsgPSBjaGFubmVsLmZpbmQoInN0cmVhbV91cmwiKS50ZXh0DQoJCXBpbHQgPSBjaGFubmVsLmZpbmQoImRlc2NfaW1hZ2UiKS50ZXh0IA0KCQlkZXNjcmlwdCA9IGNoYW5uZWwuZmluZCgiZGVzY3JpcHRpb24iKS50ZXh0DQoJCWlmIGRlc2NyaXB0Og0KCQkJZGVzY3JpcHQgPSBiYXNlNjQuYjY0ZGVjb2RlKGRlc2NyaXB0KQ0KCQlpZiBwaWx0Og0KCQkJYWRkTGlua0NhbmFsTGlzdGEocGVhbGtpcmksc3RyaWltaWxpbmsscGlsdCxkZXNjcmlwdCxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpKQ0KCQllbHNlOg0KCQkJYWRkTGlua0NhbmFsTGlzdGEocGVhbGtpcmksc3RyaWltaWxpbmssb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSxkZXNjcmlwdCxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpKQ0KCQ0KCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pICwibW92aWVzIikNCgl2aXN0YV9DYW5haXMoKQ0KDQpkZWYgYWRkTGlua0NhbmFsTGlzdGEodGl0bGUsIHVybCwgdGh1bWJuYWlsLCBwbG90LCBmYW5hcnQsIGlzUGxheWFibGU9VHJ1ZSwgZm9sZGVyPUZhbHNlKToNCglvaz1UcnVlDQoJDQoJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9dGh1bWJuYWlsLHRodW1ibmFpbEltYWdlPXRodW1ibmFpbCkNCglpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlLCJQbG90IjpwbG90fQ0KCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkNCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQ0KCWxpc3RpdGVtLnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pDQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoIlZpZGVvIiwidHJ1ZSIpDQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHN0cih1cmwpICsgIiZtb2RlPTEwJm5hbWU9IiArIHN0cihuYW1lKSArICImaWNvbmltYWdlPSIrc3RyKGljb25pbWFnZSkrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KSsiJnBsb3Q9IitzdHIocGxvdCkNCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGlzdGl0ZW0saXNGb2xkZXI9Zm9sZGVyKQ0KCXJldHVybiBvaw0KDQpkZWYgcnVuX2Nyb25qb2IodGl0bGUsdXJsLGltYWdlLHBsb3QsZmFuYXJ0KToNCgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpDQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6DQoJCXZhbmVtYV9sdWtrKG5hbWUpDQoJDQoJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KHhibWMuUExBWUxJU1RfVklERU8pDQoJcGxheWxpc3QuY2xlYXIoKQ0KCQ0KCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGUsIlBsb3QiOnBsb3R9DQoJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9aW1hZ2UsdGh1bWJuYWlsSW1hZ2U9aW1hZ2UpDQoJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQ0KCXBsYXlsaXN0LmFkZCh1cmw9dXJsLCBsaXN0aXRlbT1saXN0aXRlbSwgaW5kZXg9MSkNCgl4Ym1jLlBsYXllcigpLnBsYXkocGxheWxpc3QpDQoNCmRlZiBzeW5jX2RhdGEoY2hhbm5lbCk6DQoJdmlkZW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGNoYW5uZWwpDQoJcmV0dXJuIHZpZGVvDQoNCmRlZiByZXN0YXJ0X3NlcnZpY2UocGFyYW1zKToNCgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpDQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6DQoJCXBlYWxraXJpID0gcGFyYW1zLmdldChzeW5jX2RhdGEoImRHbDBiR1U9IikpDQoJCXZhbmVtYV9sdWtrKHBlYWxraXJpKQ0KCWxvcHBsaW5rID0gcGFyYW1zLmdldCh2b2RfY2hhbm5lbHMoImRYSnMiKSkNCgkNCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQ0KDQpkZWYgZ3JhYl9lcGcodXJsKToNCglyZXEgPSB1cmxsaWIyLlJlcXVlc3QodXJsKQ0KCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpDQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxKQ0KCWxpbms9cmVzcG9uc2UucmVhZCgpDQoJaWYgbGluayAhPSAneyJ1c2VyX2luZm8iOnsiYXV0aCI6MH19JzoNCgkJamRhdGEgPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpDQoJCXJlc3BvbnNlLmNsb3NlKCkNCgkJaWYgamRhdGE6DQoJCQlyZXR1cm4gamRhdGENCgllbHNlOg0KCQlyZXR1cm4gTm9uZQ0KCQ0KZGVmIGtvbnRyb2xsKHVybCk6DQoJcmFuZG9tc3RyaW5nID0gZ3JhYl9lcGcodXJsKQ0KCWthc3V0YWphaW5mbyA9IHJhbmRvbXN0cmluZ1tzeW5jX2RhdGEoImRYTmxjbDlwYm1adiIpXQ0KCWtvbnRyb2xsID0ga2FzdXRhamFpbmZvW2dldF9saXZlKCJZWFYwYUE9PSIpXQ0KCXJldHVybiBrb250cm9sbA0KZGVmIGdldF9saXZlKGNoYW5uZWwpOg0KCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQ0KCXJldHVybiB2aWRlbw0KZGVmIGV4ZWN1dGVfYWluZm8odXJsKToNCglhbmRtZWQgPSBncmFiX2VwZyh1cmwpDQoJa2FzdXRhamFBbmRtZWQgPSBhbmRtZWRbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0NCglzZWlzID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImMzUmhkSFZ6IildDQoJYWVndWIgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoIlpYaHdYMlJoZEdVPSIpXQ0KCWlmIGFlZ3ViOg0KCQlhZWd1YiA9IGRhdGV0aW1lLmRhdGV0aW1lLmZyb210aW1lc3RhbXAoaW50KGFlZ3ViKSkuc3RyZnRpbWUoJyVIOiVNICVkLiVtLiVZJykNCgllbHNlOg0KCQlhZWd1YiA9IHZvZF9jaGFubmVscygiVG1WMlpYST0iKSANCglyYWJiaXRzID0ga2FzdXRhamFBbmRtZWRbdm9kX2NoYW5uZWxzKCJhWE5mZEhKcFlXdz0iKV0NCglpZiByYWJiaXRzID09ICIwIjoNCgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiVG04PSIpDQoJZWxzZToNCgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiV1dWeiIpDQoJbGVhdmVtZWFsb25lID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImJXRjRYMk52Ym01bFkzUnBiMjV6IildDQoJcG9sYXJiZWFycyA9IGthc3V0YWphQW5kbWVkW3N5bmNfZGF0YSgiZFhObGNtNWhiV1U9IildDQoJDQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXVV0aWxpemFkb3I6IFsvQ09MT1JdIitwb2xhcmJlYXJzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJykpDQoJDQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUVzdGFkbzogWy9DT0xPUl0iK3NlaXMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSkNCgkNCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdRXhwaXJhOiBbL0NPTE9SXSIrYWVndWIsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSkNCgkNCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdQ29udGEgZGUgVGVzdGU6IFsvQ09MT1JdIityYWJiaXRzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJykpDQoJDQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXU1heGltbyBkZSBDb25uZWM6IFsvQ09MT1JdIitsZWF2ZW1lYWxvbmUsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSkNCgkNCgl2aXN0YV9HcnVwb3MoKQ0KDQpkZWYgdmFuZW1hX2x1a2sobmFtZSk6DQoJYSA9ICdYWFgnLCAnQWR1bHQnLCAnQWR1bHRzJywnQURVTFQnLCdBRFVMVFMnLCdhZHVsdCcsJ2FkdWx0cycsJ1Bvcm4nLCdQT1JOJywncG9ybicsJ1Bvcm4nLCd4eHgnDQoJaWYgYW55KHMgaW4gbmFtZSBmb3IgcyBpbiBhKToNCgkJeGJtYy5leGVjdXRlYnVpbHRpbigodSdYQk1DLk5vdGlmaWNhdGlvbigiQ29udHJvbG8gUGFyZW50YWwiLCAiTyBjYW5hbCBjb250ZW0gY29udGV1ZG8gYWR1bHRvIiwgMjAwMCknKSkNCgkJdGV4dCA9IHBsdWdpbnRvb2xzLmtleWJvYXJkX2lucHV0KGRlZmF1bHRfdGV4dD0iIiwgdGl0bGU9IkNvZGlnbyBwYXJhIGNvbnRyb2xvIHBhcmVudGFsIikNCgkJaWYgdGV4dD09cGx1Z2ludG9vbHMuZ2V0X3NldHRpbmcoc3luY19kYXRhKCJiRzluYVc1ZllXUjFiSFJ2Y3c9PSIpKToNCgkJICByZXR1cm4NCgkJZWxzZToNCgkJICBleGl0KCkNCgllbHNlOg0KCQluYW1lID0gIiINCg0KZGVmIERvd25sb2FkZXJDbGFzcyh1cmwsZGVzdCk6DQoJZHAgPSB4Ym1jZ3VpLkRpYWxvZ1Byb2dyZXNzKCkNCglkcC5jcmVhdGUoc3luY19kYXRhKCJSMlYwZEdsdVp5QjFjR1JoZEdVPSIpLGdldF9saXZlKCJSRzkzYm14dllXUnBibWM9IikpDQoJdXJsbGliLnVybHJldHJpZXZlKHVybCxkZXN0LGxhbWJkYSBuYiwgYnMsIGZzLCB1cmw9dXJsOiBfcGJob29rKG5iLGJzLGZzLHVybCxkcCkpDQoNCmRlZiBfcGJob29rKG51bWJsb2NrcywgYmxvY2tzaXplLCBmaWxlc2l6ZSwgdXJsPU5vbmUsZHA9Tm9uZSk6DQoJdHJ5Og0KCQlwZXJjZW50ID0gbWluKChudW1ibG9ja3MqYmxvY2tzaXplKjEwMCkvZmlsZXNpemUsIDEwMCkNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnJytwZXJjZW50KQ0KCQlkcC51cGRhdGUocGVyY2VudCkNCglleGNlcHQ6DQoJCXBlcmNlbnQgPSAxMDANCgkJZHAudXBkYXRlKHBlcmNlbnQpDQoJaWYgZHAuaXNjYW5jZWxlZCgpOg0KCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdPIGRvd25sb2FkIGZvaSBjYW5jZWxhZG8uJykNCgkJZHAuY2xvc2UoKQ0KDQpkZWYgdm9kX2NoYW5uZWxzKGNoYW5uZWwpOg0KCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQ0KCXJldHVybiB2aWRlbw0KDQpkZWYgUGxheVVybChuYW1lLCB1cmwsIGljb25pbWFnZT1Ob25lKToNCglsaXN0aXRlbSA9IHhibWNndWkuTGlzdEl0ZW0ocGF0aD11cmwsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkNCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUgfSkNCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQ0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMJCQkJCQkJCQkJCQkJTWVudSBUViBBcnF1aXZvCQkJCQkJCQkJCQkgIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCmRlZiBsaXN0YXR2YXJjaGl2ZSh1cmwpOg0KCWVuZGVyZWNvID0gdXJsKyIvcGFuZWxfYXBpLnBocD91c2VybmFtZT0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrIiZwYXNzd29yZD0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKyImYWN0aW9uPWdldF9saXZlX3N0cmVhbXMiDQoJaUlpSUlJaSA9IHVybGxpYjIudXJsb3BlbihlbmRlcmVjbykNCglvb28wME9PT29vTwk9IGpzb24ubG9hZChpSWlJSUlpKQ0KCU8wME9PT29Pb28wTyA9IG9vbzAwT09Pb29PWydhdmFpbGFibGVfY2hhbm5lbHMnXQ0KCWZvcglPMDAwT09vMDBvbwlpbglPMDBPT09vT29vME8udmFsdWVzKCk6DQoJCW9vME9PbyA9IE8wMDBPT28wMG9vWyd0dl9hcmNoaXZlJ10NCgkJaWYob28wT09vID09IDEpOg0KCQkJbmFtZXR2PU8wMDBPT28wMG9vWyduYW1lJ10NCgkJCXN0cmVhbV9pZD1PMDAwT09vMDBvb1snc3RyZWFtX2lkJ10NCgkJCWxvZ29fdHY9TzAwME9PbzAwb29bJ3N0cmVhbV9pY29uJ10NCgkJCWR1cmF0aW9uID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmVfZHVyYXRpb24nXQ0KCQkJDQoJCQlhZGRMaW5rR3J1cG8obmFtZXR2LGxvZ29fdHYsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHZfYXJjLnBuZycpLDEpDQoJDQoJdmlzdGFfR3J1cG9zKCkNCg0KZGVmIGxpc3RhdHZhcmNoaXZlY2FuYWlzKG5hbWUsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixpY29uaW1hZ2UsZmFuYXJ0KToNCgllbmRlcmVjbyA9IHVybCsiL3BhbmVsX2FwaS5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJmFjdGlvbj1nZXRfZXBnJnN0cmVhbV9pZD0iK3N0cmVhbV9pZA0KCWlJaUlJSWkJPQl1cmxsaWIyCS51cmxvcGVuKGVuZGVyZWNvKQ0KCWlpaUkxMQk9CWpzb24ubG9hZChpSWlJSUlpKQ0KCWlpSWlJCT0JZGF0ZXRpbWUuZGF0ZXRpbWUudXRjbm93KCkgLSBkYXRldGltZS50aW1lZGVsdGEoZGF5cz1pbnQoZHVyYXRpb24pKQ0KCW8wMG9vb08wT28JPWNhbGVuZGFyLnRpbWVnbShpaUlpSS50aW1ldHVwbGUoKSkNCglvMDBvb29PME9vCT1pbnQobzAwb29vTzBPbykNCglvME8wT09PME9vbwk9dGltZS50aW1lKCkNCglvME8wT09PME9vbwk9aW50KG8wTzBPT08wT29vKQ0KCQ0KCWZvcglpaUlpSUkxCWluCWlpaUkxMQk6DQoJCXRpdGxlX3R2ID0gaWlJaUlJMVsndGl0bGUnXQ0KCQl0aXRsZV90dj1iYXNlNjQuYjY0ZGVjb2RlKHRpdGxlX3R2KQ0KCQlzdGFydAk9IGludChpaUlpSUkxWydzdGFydCddKQ0KCQllbmQJPSBpbnQoaWlJaUlJMVsnZW5kJ10pDQoJCXNlZ3VuZG8gPSAwLjAxNjY2NjY2NjcNCgkJDQoJCWR1cmFjYW8gPSBpbnQoKGVuZC1zdGFydCkqc2VndW5kbykNCgkJDQoJCWlmKHN0YXJ0ID4gbzAwb29vTzBPbyBhbmQgc3RhcnQgPCBvME8wT09PME9vbyk6DQoJCQlpZiA5MCAtIDkwOglPb28wCSUJT28wb29PMG9vMG9PCS8JT28wb08wb29vDQoJCQlJSWkgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChzdGFydCkpLnN0cmZ0aW1lKCclZC4lbSAlSDolTScpDQoJCQlpMUlpaTFpMUkgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChzdGFydCkpLnN0cmZ0aW1lKCclWS0lbS0lZDolSDolTScpDQoJCQl0aXRsZV90diA9IElJaSArICIgIiArIHRpdGxlX3R2DQoJCQllbmRlcmVjbyA9IHVybCsiL3N0cmVhbWluZy90aW1lc2hpZnQucGhwP3VzZXJuYW1lPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsiJnBhc3N3b3JkPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrIiZzdHJlYW09IitzdHJlYW1faWQrIiZzdGFydD0iK2kxSWlpMWkxSSsiJmR1cmF0aW9uPSIrc3RyKGR1cmFjYW8pDQoJCQkNCgkJCWFkZExpbmtDYW5hbCh0aXRsZV90dixlbmRlcmVjbyxpY29uaW1hZ2UsJzAwMDEnLCcnKQ0KCQ0KCXZpc3RhX0NhbmFpcygpDQoNCmRlZiBhZGRMaW5rR3J1cG8odGl0bGUsdGh1bWJuYWlsLHN0cmVhbV9pZCx1cmwsZHVyYXRpb24sZmFuYXJ0LHR5cGUpOg0KCW9rPVRydWUNCgkNCglsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT10aHVtYm5haWwsdGh1bWJuYWlsSW1hZ2U9dGh1bWJuYWlsKQ0KCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGV9DQoJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQ0KCWxpc3RpdGVtLnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLGZhbmFydCkNCgl4Ym1jcGx1Z2luLnNldFBsdWdpbkZhbmFydChpbnQoc3lzLmFyZ3ZbMV0pLGZhbmFydCkNCgkNCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgc3RyKHVybCkgKyAiJm1vZGU9NyZuYW1lPSIgKyBzdHIodGl0bGUpICsgIiZpY29uaW1hZ2U9IitzdHIodGh1bWJuYWlsKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpKyImc3RyZWFtX2lkPSIrc3RyKHN0cmVhbV9pZCkrIiZkdXJhdGlvbj0iK2R1cmF0aW9uDQoJDQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpc3RpdGVtLGlzRm9sZGVyPVRydWUpDQoJDQoJcmV0dXJuIG9rDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIwkJCQkJCQkJCQkJCQlBYnJpciBTZXR0aW5nCQkJCQkJCQkJCSAjDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCg0KZGVmIGFicmlyRGVmaW5pbmNvZXMoKToNCglfX0FERE9OX18ub3BlblNldHRpbmdzKCkNCgl2aXN0YV9tZW51KCkNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIwkJQ2xlYXIgQ2FjaGUJCSMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCg0KZGVmIENMRUFSQ0FDSEUoKToNCgl4Ym1jX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vaG9tZScpLCAnY2FjaGUnKQ0KCWlmIG9zLnBhdGguZXhpc3RzKHhibWNfY2FjaGVfcGF0aCk9PVRydWU6CQ0KCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayh4Ym1jX2NhY2hlX3BhdGgpOg0KCQkJZmlsZV9jb3VudCA9IDANCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQ0KCQkJaWYgZmlsZV9jb3VudCA+IDA6DQoJDQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQ0KCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIENhY2hlIG5vIFhCTUMuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToNCgkJCQkNCgkJCQkJZm9yIGYgaW4gZmlsZXM6DQoJCQkJCQl0cnk6DQoJCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkNCgkJCQkJCWV4Y2VwdDoNCgkJCQkJCQlwYXNzDQoJCQkJCWZvciBkIGluIGRpcnM6DQoJCQkJCQl0cnk6DQoJCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpDQoJCQkJCQlleGNlcHQ6DQoJCQkJCQkJcGFzcw0KCQkJCQkJDQoJCQllbHNlOg0KCQkJCXBhc3MNCglpZiB4Ym1jLmdldENvbmRWaXNpYmlsaXR5KCdzeXN0ZW0ucGxhdGZvcm0uQVRWMicpOg0KCQlhdHYyX2NhY2hlX2EgPSBvcy5wYXRoLmpvaW4oJy9wcml2YXRlL3Zhci9tb2JpbGUvTGlicmFyeS9DYWNoZXMvQXBwbGVUVi9WaWRlby8nLCAnT3RoZXInKQ0KCQkNCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoYXR2Ml9jYWNoZV9hKToNCgkJCWZpbGVfY291bnQgPSAwDQoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykNCgkJDQoJCQlpZiBmaWxlX2NvdW50ID4gMDoNCg0KCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkNCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgQVRWMi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcyBlbSAnT3V0cm9zJyIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6DQoJCQkJDQoJCQkJCWZvciBmIGluIGZpbGVzOg0KCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkNCgkJCQkJZm9yIGQgaW4gZGlyczoNCgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQ0KCQkJCQkJDQoJCQllbHNlOg0KCQkJCXBhc3MNCgkJYXR2Ml9jYWNoZV9iID0gb3MucGF0aC5qb2luKCcvcHJpdmF0ZS92YXIvbW9iaWxlL0xpYnJhcnkvQ2FjaGVzL0FwcGxlVFYvVmlkZW8vJywgJ0xvY2FsQW5kUmVudGFsJykNCgkJDQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGF0djJfY2FjaGVfYik6DQoJCQlmaWxlX2NvdW50ID0gMA0KCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpDQoJCQ0KCQkJaWYgZmlsZV9jb3VudCA+IDA6DQoNCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpDQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEFUVjIuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MgZW0gJ0xvY2FsJyIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6DQoJCQkJDQoJCQkJCWZvciBmIGluIGZpbGVzOg0KCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkNCgkJCQkJZm9yIGQgaW4gZGlyczoNCgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQ0KCQkJCQkJDQoJCQllbHNlOg0KCQkJCXBhc3MNCgkJCSAgIyBTZXQgcGF0aCB0byBDeWRpYSBBcmNoaXZlcyBjYWNoZSBmaWxlcw0KCQkJCQkJCSANCg0KCSMgU2V0IHBhdGggdG8gV2hhdCB0aCBGdXJrIGNhY2hlIGZpbGVzDQoJd3RmX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby53aGF0dGhlZnVyay9jYWNoZScpLCAnJykNCglpZiBvcy5wYXRoLmV4aXN0cyh3dGZfY2FjaGVfcGF0aCk9PVRydWU6CQ0KCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayh3dGZfY2FjaGVfcGF0aCk6DQoJCQlmaWxlX2NvdW50ID0gMA0KCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpDQoJCQ0KCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUNCgkJCWlmIGZpbGVfY291bnQgPiAwOg0KCQ0KCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkNCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBhIGNhY2hlIFdURi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOg0KCQkJCQ0KCQkJCQlmb3IgZiBpbiBmaWxlczoNCgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpDQoJCQkJCWZvciBkIGluIGRpcnM6DQoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkNCgkJCQkJCQ0KCQkJZWxzZToNCgkJCQlwYXNzDQoJCQkJDQoJCQkJIyBTZXQgcGF0aCB0byA0b0QgY2FjaGUgZmlsZXMNCgljaGFubmVsNF9jYWNoZV9wYXRoPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby40b2QvY2FjaGUnKSwgJycpDQoJaWYgb3MucGF0aC5leGlzdHMoY2hhbm5lbDRfY2FjaGVfcGF0aCk9PVRydWU6CQ0KCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhjaGFubmVsNF9jYWNoZV9wYXRoKToNCgkJCWZpbGVfY291bnQgPSAwDQoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykNCgkJDQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQ0KCQkJaWYgZmlsZV9jb3VudCA+IDA6DQoJDQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQ0KCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyA0b0QgZW0gY2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToNCgkJCQkNCgkJCQkJZm9yIGYgaW4gZmlsZXM6DQoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQ0KCQkJCQlmb3IgZCBpbiBkaXJzOg0KCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpDQoJCQkJCQkNCgkJCWVsc2U6DQoJCQkJcGFzcw0KCQkJCQ0KCQkJCSMgU2V0IHBhdGggdG8gQkJDIGlQbGF5ZXIgY2FjaGUgZmlsZXMNCglpcGxheWVyX2NhY2hlX3BhdGg9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLmlwbGF5ZXIvaXBsYXllcl9odHRwX2NhY2hlJyksICcnKQ0KCWlmIG9zLnBhdGguZXhpc3RzKGlwbGF5ZXJfY2FjaGVfcGF0aCk9PVRydWU6CQ0KCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhpcGxheWVyX2NhY2hlX3BhdGgpOg0KCQkJZmlsZV9jb3VudCA9IDANCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQ0KCQkNCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlDQoJCQlpZiBmaWxlX2NvdW50ID4gMDoNCgkNCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpDQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEJCQyBpUGxheWVyIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6DQoJCQkJDQoJCQkJCWZvciBmIGluIGZpbGVzOg0KCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkNCgkJCQkJZm9yIGQgaW4gZGlyczoNCgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQ0KCQkJCQkJDQoJCQllbHNlOg0KCQkJCXBhc3MNCgkJCQkNCgkJCQkNCgkJCQkjIFNldCBwYXRoIHRvIFNpbXBsZSBEb3dubG9hZGVyIGNhY2hlIGZpbGVzDQoJZG93bmxvYWRlcl9jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9zY3JpcHQubW9kdWxlLnNpbXBsZS5kb3dubG9hZGVyJyksICcnKQ0KCWlmIG9zLnBhdGguZXhpc3RzKGRvd25sb2FkZXJfY2FjaGVfcGF0aCk9PVRydWU6CQ0KCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayhkb3dubG9hZGVyX2NhY2hlX3BhdGgpOg0KCQkJZmlsZV9jb3VudCA9IDANCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQ0KCQkNCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlDQoJCQlpZiBmaWxlX2NvdW50ID4gMDoNCgkNCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpDQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIFNpbXBsZSBEb3dubG9hZGVyIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6DQoJCQkJDQoJCQkJCWZvciBmIGluIGZpbGVzOg0KCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkNCgkJCQkJZm9yIGQgaW4gZGlyczoNCgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQ0KCQkJCQkJDQoJCQllbHNlOg0KCQkJCXBhc3MNCgkNCglpdHZfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLml0di9JbWFnZXMnKSwgJycpDQoJaWYgb3MucGF0aC5leGlzdHMoaXR2X2NhY2hlX3BhdGgpPT1UcnVlOgkNCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoaXR2X2NhY2hlX3BhdGgpOg0KCQkJZmlsZV9jb3VudCA9IDANCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQ0KCQkJDQoJCQlpZiBmaWxlX2NvdW50ID4gMDoNCgkNCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpDQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgaXRlbXMgZW0gY2FjaGUiLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOg0KCQkJCQ0KCQkJCQlmb3IgZiBpbiBmaWxlczoNCgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpDQoJCQkJCWZvciBkIGluIGRpcnM6DQoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkNCgkJCQkJCQ0KCQkJZWxzZToNCgkJCQlwYXNzDQoJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQ0KCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiCQlDYWNoZSBhcGFnYWRhIGNvbSBzdWNlc3NvISIpDQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMjIwkgUHVyZ2UgUGFja2FnZXMJCSMjIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCg0KZGVmIFBVUkdFUEFDS0FHRVMoKToNCglwYWNrYWdlc19jYWNoZV9wYXRoID0geGJtYy50cmFuc2xhdGVQYXRoKG9zLnBhdGguam9pbignc3BlY2lhbDovL2hvbWUvYWRkb25zL3BhY2thZ2VzJywgJycpKQ0KCXRyeToJDQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHBhY2thZ2VzX2NhY2hlX3BhdGgpOg0KCQkJZmlsZV9jb3VudCA9IDANCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQ0KCQkJDQoJCQlpZiBmaWxlX2NvdW50ID4gMDoNCgkNCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpDQoJCQkJaWYgZGlhbG9nLnllc25vKCJFeGNsdWlyIGluZm9ybWHDp8OjbyBlbSBDYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zPyIpOg0KCQkJCQkJCQ0KCQkJCQlmb3IgZiBpbiBmaWxlczoNCgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpDQoJCQkJCWZvciBkIGluIGRpcnM6DQoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkNCgkJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQ0KCQkJCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJS29kaSBsaW1wbyBjb20gc3VjZXNzby4iKQ0KCQkJCWVsc2U6DQoJCQkJCQlwYXNzDQoJCQllbHNlOg0KCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkNCgkJCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJTsOjbyBmb3JhbSBlbmNvbnRyYWRvcyBmaWNoZWlyb3MgYSBhcGFnYXIuIikNCglleGNlcHQ6IA0KCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpDQoJCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiRXJybyBhbyB0ZW50YXIgYXBhZ2FyIGZpY2hlaXJvcyBlbSBjYWNoZS4iKQ0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMJCQkJCQkJCQkJCQlBZGRvbiBGaWxtZXMgZSBTZXJpZXMJCQkJCQkJCQkgICMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQpkZWYgbGlzdGFtZW51c3Nlcmllcyhub21lX25vdix1cmwsaWNvbmltYWdlLGZhbmFydCk6DQoJY2hlY2tfbG9naW4gPSBsb2dpbjIoKQ0KCWlmIGNoZWNrX2xvZ2luID09IFRydWU6DQoJCW1lbnVTZXJpZXMoaWNvbmltYWdlLGZhbmFydCkNCgllbHNlOg0KCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpDQoNCmRlZiBsaXN0YW1lbnVzZmlsbWVzKG5vbWVfbm92LHVybCxpY29uaW1hZ2UsZmFuYXJ0KToNCgljaGVja19sb2dpbiA9IGxvZ2luMigpDQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToNCgkJZGF0YWJhc2UgPSBEYXRhYmFzZS5pc0V4aXN0cygpDQoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyx1cmwsNCwnTWluaWF0dXJhJyxpY29uaW1hZ2UsJ2ZpbG1lcycsZmFuYXJ0KQkNCgkJbWVudUZpbG1lcyhpY29uaW1hZ2UsZmFuYXJ0KQ0KCWVsc2U6DQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykNCg0KZGVmIGxpc3RhbWVudXNhbmltZXMobm9tZV9ub3YsdXJsLGljb25pbWFnZSxmYW5hcnQpOg0KCWNoZWNrX2xvZ2luID0gbG9naW4yKCkNCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOg0KCQltZW51QW5pbWVzKGljb25pbWFnZSxmYW5hcnQpDQoJZWxzZToNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQ0KDQpkZWYgbWVudUZpbG1lcyhpY29uaW1hZ2UsZmFuYXJ0KToNCglldmVudG8gPSBnZXRFdmVudG9zKCkNCglpZiBldmVudG86DQoJCWFkZERpcjIoJ1tCXScrZXZlbnRvKydbL0JdJywgX19BUElfU0lURV9fKydldmVudG8vMScsIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQ0KCQlhZGREaXIyKCcgJywgJycsIDAsICcnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnbmFkYS5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQ0KCWFkZERpcjIoJ1RvZG9zIG9zIEZpbG1lcycsIF9fQVBJX1NJVEVfXysnZmlsbWVzJywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpDQoJYWRkRGlyMignRmlsbWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnZmlsbWVzL2Rlc3RhcXVlJywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpDQoJYWRkRGlyMignRmlsbWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ2ZpbG1lcy9hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkNCglhZGREaXIyKCdGaWxtZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnZmlsbWVzL2NhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQ0KDQoJdmlzdGFfbWVudSgpDQoNCmRlZiBtZW51U2VyaWVzKGljb25pbWFnZSxmYW5hcnQpOg0KCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQ0KCWFkZERpcjIoJ1RvZGFzIGFzIFNlcmllcycsIF9fQVBJX1NJVEVfXysnc2VyaWVzJywgMTIzLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpDQoJYWRkRGlyMignU2VyaWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnc2VyaWVzL2Rlc3RhcXVlJywgMTIzLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpDQoJYWRkRGlyMignU2VyaWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy9hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkNCglhZGREaXIyKCdTZXJpZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnc2VyaWVzL2NhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQ0KDQoJdmlzdGFfbWVudSgpDQoNCmRlZiBtZW51QW5pbWVzKGljb25pbWFnZSxmYW5hcnQpOg0KCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQ0KCWFkZERpcjIoJ1RvZG9zIG9zIEFuaW1lcycsIF9fQVBJX1NJVEVfXysnYW5pbWVzJywgMTIzLCAnYW5pbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpDQoJYWRkRGlyMignQW5pbWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnYW5pbWVzL2Rlc3RhcXVlJywgMTIzLCAnYW5pbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpDQoJYWRkRGlyMignQW5pbWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ2FuaW1lcy9hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkNCglhZGREaXIyKCdBbmltZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnYW5pbWVzL2NhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQ0KDQoJdmlzdGFfbWVudSgpDQoNCmRlZiByZW1vdmVyQWNlbnRvcyh0eHQsIGVuY29kaW5nPSd1dGYtOCcpOg0KCXJldHVybiBub3JtYWxpemUoJ05GS0QnLCB0eHQuZGVjb2RlKGVuY29kaW5nKSkuZW5jb2RlKCdBU0NJSScsJ2lnbm9yZScpDQoNCmRlZiBmaWxtZXModXJsLCBwYWdpbmEpOg0KCWhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQ0KCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzKQ0KCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gYWRkb24uJykNCgkJcmV0dXJuIEZhbHNlDQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pDQoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106DQoJCWNhdGVnb3JpYSA9IGlbJ2NhdGVnb3JpYTEnXQ0KCQlpZiBpWydjYXRlZ29yaWEyJ10gIT0gJyc6DQoJCQljYXRlZ29yaWEgKz0gJywnK2lbJ2NhdGVnb3JpYTInXQ0KCQlpZiBpWydjYXRlZ29yaWEzJ10gIT0gJyc6DQoJCQljYXRlZ29yaWEgKz0gJywnK2lbJ2NhdGVnb3JpYTMnXQ0KCQl2aXN0byA9IEZhbHNlDQoJCXB0ID0gJycNCgkJY29yID0gIndoaXRlIg0KCQliciA9ICcnDQoJCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6DQoJCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nDQoJCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOg0KCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQlpZiAnUFQnIGluIGlbJ0lNQkQnXToNCgkJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0NCgkJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScNCgkJaWYgaVsndmlzdG8nXSA9PSAxOg0KCQkJdmlzdG8gPSBUcnVlDQoNCgkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBpWydub21lX2luZ2xlcyddLCAnWWVhcic6IGlbJ2FubyddLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzogaVsnZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzppWydhdG9yZXMnXS5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IGlbJ3RyYWlsZXInXSwgJ0RpcmVjdG9yJzogaVsnZGlyZXRvciddLCAnUmF0aW5nJzogaVsnaW1kYlJhdGluZyddLCAnSU1EQk51bWJlcic6IGlbJ0lNQkQnXSB9DQoJCQ0KCQl0cnk6DQoJCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykNCgkJZXhjZXB0Og0KCQkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpDQoJCWlmICdodHRwJyBub3QgaW4gaVsnZm90byddOg0KCQkJaVsnZm90byddID0gX19BUElfXysnaW1hZ2VzL2NhcGFzLycraVsnZm90byddLnNwbGl0KCcvJylbLTFdDQoJCQkjaVsnZm90byddID0gaVsnZm90byddLnJlcGxhY2UoJ1BUJywnJykNCgkJDQoJCW5vbWVlZSA9ICdbQ09MT1IgJytjb3IrJ10nK3B0K2JyK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJylbL0NPTE9SXScNCgkJdXJsbm9vID0gX19BUElfU0lURV9fKydmaWxtZS8nK3N0cihpWydpZF92aWRlbyddKQ0KCQlmb3Rvb28gPSBpWydmb3RvJ10NCgkJI2lbJ2JhY2tncm91bmQnXSA9IGlbJ2JhY2tncm91bmQnXS5yZXBsYWNlKCdQVCcsJycpDQoJCWlbJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2lbJ0lNQkQnXSsnLmpwZycNCgkJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQ0KCQlhZGRWaWRlbyhub21lZWUsIHVybG5vbywgMTEzLCBmb3Rvb28sdmlzdG8sICdmaWxtZScsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPWlbJ3RyYWlsZXInXSkNCgkJDQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmF0aW9uJ11bJ2N1cnJlbnRfcGFnZSddDQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hdGlvbiddWyd0b3RhbF9wYWdlcyddDQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYXRpb24nXVsnbGlua3MnXVsnbmV4dCddDQoJZXhjZXB0OiBwYXNzIA0KCWlmIGN1cnJlbnQgPCB0b3RhbDoNCgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEsICdmaWxtZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQ0KCXZpc3RhX2ZpbG1lc1NlcmllcygpDQoNCmRlZiBzZXJpZXModXJsKToNCgloZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykNCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycykNCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6DQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIGFkZG9uLicpDQoJCXJldHVybiBGYWxzZQ0KCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQ0KCWlmICdzZXJpZScgaW4gdXJsOg0KCQl0aXBvID0gJ3NlcmllJw0KCWVsaWYgJ2FuaW1lJyBpbiB1cmw6DQoJCXRpcG8gPSAnYW5pbWUnDQoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106DQoJCWNhdGVnb3JpYSA9IGlbJ2NhdGVnb3JpYTEnXQ0KCQlpZiBpWydjYXRlZ29yaWEyJ10gIT0gJyc6DQoJCQljYXRlZ29yaWEgKz0gJywnK2lbJ2NhdGVnb3JpYTInXQ0KCQlpZiBpWydjYXRlZ29yaWEzJ10gIT0gJyc6DQoJCQljYXRlZ29yaWEgKz0gJywnK2lbJ2NhdGVnb3JpYTMnXQ0KCQliciA9ICcnDQoJCXB0ID0gJycNCgkJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToNCgkJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScNCgkJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6DQoJCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nDQoJCWlmICdQVCcgaW4gaVsnSU1CRCddOg0KCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQlpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogaVsnYW5vJ10sICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBpWydkZXNjcmljYW9fdmlkZW8nXSwgJ0Nhc3QnOmlbJ2F0b3JlcyddLnNwbGl0KCcsJyksICdUcmFpbGVyJzogaVsndHJhaWxlciddLCAnRGlyZWN0b3InOiBpWydkaXJldG9yJ10sICdSYXRpbmcnOiBpWydpbWRiUmF0aW5nJ10sICdDb2RlJzogaVsnSU1CRCddIH0NCgkNCgkJdHJ5Og0KCQkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZGVjb2RlKCd1dGYtOCcpDQoJCWV4Y2VwdDoNCgkJCW5vbWUgPSBpWydub21lX2luZ2xlcyddLmVuY29kZSgndXRmLTgnKQ0KCQlpZiAnaHR0cCcgbm90IGluIGlbJ2ZvdG8nXToNCgkJCWlbJ2ZvdG8nXSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ZvdG8nXS5zcGxpdCgnLycpWy0xXQ0KCQkJI2lbJ2ZvdG8nXSA9IGlbJ2ZvdG8nXS5yZXBsYWNlKCdQVCcsJycpDQoJCWlmIGlbJ3Zpc3RvJ10gPT0gMToNCgkJCXZpc3RvPVRydWUNCgkJZWxzZToNCgkJCXZpc3RvPUZhbHNlDQoJCQ0KCQkNCgkJbm9tZWVlID0gcHQrYnIrcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJytpWydhbm8nXSsnKScNCgkJZm90b29vID0gaVsnZm90byddDQoJCSNpWydiYWNrZ3JvdW5kJ10gPSBpWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQ0KCQlpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnDQoJCWZhbmFydHR0ID0gX19BUElfXytpWydiYWNrZ3JvdW5kJ10NCgkJYWRkRGlyMihub21lZWUsIF9fQVBJX1NJVEVfXyt0aXBvKycvJytzdHIoaVsnaWRfdmlkZW8nXSksIDExNCwgJ3RlbXBvcmFkYXMnLCBmb3Rvb28sIHRpcG89J3NlcmllJywgaW5mb0xhYmVscz1pbmZvTGFiZWxzLHBvc3Rlcj1mYW5hcnR0dCx2aXN0bz12aXN0bykNCgkNCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYXRpb24nXVsnY3VycmVudF9wYWdlJ10NCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmF0aW9uJ11bJ3RvdGFsX3BhZ2VzJ10NCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hdGlvbiddWydsaW5rcyddWyduZXh0J10NCglleGNlcHQ6IHBhc3MgDQoJaWYgY3VycmVudCA8IHRvdGFsOg0KCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjMsICdzZXJpZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkNCgkNCgl2aXN0YV9maWxtZXNTZXJpZXMoKQ0KDQpkZWYgZ2V0U2Vhc29ucyh1cmwpOg0KCWhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQ0KCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzKQ0KCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gYWRkb24uJykNCgkJcmV0dXJuIEZhbHNlDQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pDQoJaj0xDQoJd2hpbGUgaiA8PSByZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXToNCgkJYWRkRGlyMigiW0JdVGVtcG9yYWRhWy9CXSAiK3N0cihqKSwgdXJsKycvdGVtcG9yYWRhLycrc3RyKGopLCAxMTUsICdlcGlzb2Rpb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCd0ZW1wb3JhZGFzJywgJ3RlbXBvcmFkYScrc3RyKGopKycucG5nJykscG9zdGVyPV9fQVBJX18rcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10pDQoJCWorPTENCgkNCgl2aXN0YV90ZW1wb3JhZGFzKCkNCg0KZGVmIGdldEVwaXNvZGVzKHVybCk6DQoJaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpDQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMpDQoJaWYgcmVzdWx0YWRvID09ICdETlMnOg0KCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBhZGRvbi4nKQ0KCQlyZXR1cm4gRmFsc2UNCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykNCglpZiAnc2VyaWUnIGluIHVybDoNCgkJdGlwbyA9ICdzZXJpZScNCgllbGlmICdhbmltZScgaW4gdXJsOg0KCQl0aXBvID0gJ2FuaW1lJw0KCWhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQ0KCXJlc3VsdGFkb1MgPSBhYnJpcl91cmwoX19BUElfU0lURV9fK3RpcG8rJy8nK3VybC5zcGxpdCgnLycpWzVdLCBoZWFkZXI9aGVhZGVycykNCglyZXN1bHRhZG9TID0ganNvbi5sb2FkcyhyZXN1bHRhZG9TKQ0KCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOg0KCQlpZiBpWydVUkwnXSA9PSAnJyBhbmQgaVsnVVJMMiddID09ICcnOg0KCQkJY29udGludWUNCgkJcHQgPSAnJw0KCQljYXRlZ29yaWEgPSByZXN1bHRhZG9TWydjYXRlZ29yaWExJ10NCgkJaWYgcmVzdWx0YWRvU1snY2F0ZWdvcmlhMiddICE9ICcnOg0KCQkJY2F0ZWdvcmlhICs9ICcsJytyZXN1bHRhZG9TWydjYXRlZ29yaWEyJ10NCgkJaWYgcmVzdWx0YWRvU1snY2F0ZWdvcmlhMyddICE9ICcnOg0KCQkJY2F0ZWdvcmlhICs9ICcsJytyZXN1bHRhZG9TWydjYXRlZ29yaWEzJ10NCgkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBpWydub21lX2VwaXNvZGlvJ10sICdDb2RlJzogaVsnSU1CRCddLCAnRXBpc29kZSc6IGlbJ2VwaXNvZGlvJ10sICdTZWFzb24nOiBpWyd0ZW1wb3JhZGEnXSB9DQoJCXRyeToNCgkJCW5vbWUgPSBpWydub21lX2VwaXNvZGlvJ10uZGVjb2RlKCd1dGYtOCcpDQoJCWV4Y2VwdDoNCgkJCW5vbWUgPSBpWydub21lX2VwaXNvZGlvJ10uZW5jb2RlKCd1dGYtOCcpDQoJCWJyID0gJycNCgkJZmluYWwgPSAnJw0KCQlzZW1MZWdlbmRhID0gJycNCgkJaWYgaVsnZmltdGVtcG9yYWRhJ10gPT0gMToNCgkJCWZpbmFsID0gJ1tCXUZpbmFsIGRhIFRlbXBvcmFkYSBbL0JdJw0KCQlpZiBpWydzZW1sZWdlbmRhJ10gPT0gMToNCgkJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScNCgkJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToNCgkJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScNCgkJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6DQoJCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nDQoJCWlmICdQVCcgaW4gaVsnSU1CRCddOg0KCQkJaVsnSU1CRCddID0gcmUuY29tcGlsZSgnKC4rPylQVCcpLmZpbmRhbGwoaVsnSU1CRCddKVswXQ0KCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQl2aXN0byA9IEZhbHNlDQoJCWNvciA9ICd3aGl0ZScNCgkJaWYgaVsndmlzdG8nXSA9PSAxOg0KCQkJdmlzdG8gPSBUcnVlCQ0KCQkNCgkJaW1hZ2VtID0gJycNCgkJaWYgaVsnaW1hZ2VtJ10gPT0gMToNCgkJCWltYWdlbSA9IF9fQVBJX18rJ2ltYWdlcy9zZXJpZXMvJytpWydJTUJEJ10rJy5qcGcnDQoJCWVsaWYgaVsnaW1hZ2VtJ10gPT0gMDoNCgkJCWltYWdlbSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ltZGJTZXJpZSddKycuanBnJw0KCQkNCgkJI2ltYWdlbSA9IGltYWdlbS5yZXBsYWNlKCdQVCcsJycpDQoJCSNpWydiYWNrZ3JvdW5kJ10gPSBpWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQ0KCQlpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnDQoJCWZhbmFydHR0ID0gX19BUElfXytpWydiYWNrZ3JvdW5kJ10NCgkJDQoJCW5vbWVlZSA9IHB0K2JyK2ZpbmFsK3NlbUxlZ2VuZGErJ1tDT0xPUiAnK2NvcisnXVtCXUVwaXNvZGlvICcrc3RyKGlbJ2VwaXNvZGlvJ10pKydbL0JdWy9DT0xPUl0gJytyZW1vdmVyQWNlbnRvcyhub21lKQ0KCQkNCgkJYWRkVmlkZW8obm9tZWVlLCBfX0FQSV9TSVRFX18rdGlwbysnLycrc3RyKGlbJ2lkX3NlcmllJ10pKycvZXBpc29kaW8vJytzdHIoaVsnaWRfZXBpc29kaW8nXSksIDExMywgaW1hZ2VtLCB2aXN0bywgJ2VwaXNvZGlvJywgaVsndGVtcG9yYWRhJ10sIGlbJ2VwaXNvZGlvJ10sIGluZm9MYWJlbHMsIGZhbmFydHR0KQ0KCQ0KCXZpc3RhX2VwaXNvZGlvcygpDQoNCmRlZiBnZXRHZW5lcm9zKHVybCk6DQoJaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpDQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnY2F0ZWdvcmlhcycsIGhlYWRlcj1oZWFkZXJzKQ0KCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gYWRkb24uJykNCgkJcmV0dXJuIEZhbHNlDQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pDQoNCglmb3IgaSBpbiByZXN1bHRhZG86DQoJCWlmIGlbJ2lkX2NhdGVnb3JpYSddID09IDA6DQoJCQljb250aW51ZQ0KCQlpZiAnZmlsbWUnIG5vdCBpbiB1cmwgYW5kIGlbJ3RpcG8nXSA9PSAxOg0KCQkJY29udGludWUNCgkJYWRkRGlyMihpWydjYXRlZ29yaWFzJ10sIHVybCsnLycrc3RyKGlbJ2lkX2NhdGVnb3JpYSddKSwgMTIyLCAnY2F0ZWdvcmlhcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdmlkLnBuZycpKQ0KCQ0KCXZpc3RhX21lbnUoKQ0KDQpkZWYgY2F0ZWdvcmlhcyh1cmwpOg0KCWhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQ0KCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzKQ0KCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gYWRkb24uJykNCgkJcmV0dXJuIEZhbHNlDQoJcmVzdWx0YWRvYSA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQ0KCQ0KCWZvciBpIGluIHJlc3VsdGFkb2FbImRhdGEiXToNCgkJaWYgJ2ZpbG1lJyBpbiB1cmw6DQoJCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydmaWxtZS8nK3N0cihpWydpZF92aWRlbyddKSwgaGVhZGVyPWhlYWRlcnMpDQoJCQlyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykNCgkJCWNhdGVnb3JpYSA9IHJlc3VsdGFkb1snY2F0ZWdvcmlhMSddDQoJCQlpZiByZXN1bHRhZG9bJ2NhdGVnb3JpYTInXSAhPSAnJzoNCgkJCQljYXRlZ29yaWEgKz0gJywnK3Jlc3VsdGFkb1snY2F0ZWdvcmlhMiddDQoJCQlpZiByZXN1bHRhZG9bJ2NhdGVnb3JpYTMnXSAhPSAnJzoNCgkJCQljYXRlZ29yaWEgKz0gJywnK3Jlc3VsdGFkb1snY2F0ZWdvcmlhMyddDQoJCQkNCgkJCXRyeToNCgkJCQlub21lID0gcmVzdWx0YWRvWydub21lX2luZ2xlcyddLmRlY29kZSgndXRmLTgnKQ0KCQkJZXhjZXB0Og0KCQkJCW5vbWUgPSByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpDQoJCQlpZiAnaHR0cCcgbm90IGluIHJlc3VsdGFkb1snZm90byddOg0KCQkJCXJlc3VsdGFkb1snZm90byddID0gX19BUElfXysnaW1hZ2VzL2NhcGFzLycrcmVzdWx0YWRvWydmb3RvJ10uc3BsaXQoJy8nKVstMV0NCgkJCXB0ID0gJycNCgkJCWJyID0gJycNCgkJCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6DQoJCQkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJw0KCQkJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6DQoJCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQkJY29yID0gIndoaXRlIg0KCQkJaWYgJ1BUJyBpbiByZXN1bHRhZG9bJ0lNQkQnXToNCgkJCQlyZXN1bHRhZG9bJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKHJlc3VsdGFkb1snSU1CRCddKVswXQ0KCQkJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScNCgkJCXZpc3RvID0gRmFsc2UNCgkJCQ0KCQkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogcmVzdWx0YWRvWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6cmVzdWx0YWRvWydkZXNjcmljYW9fdmlkZW8nXSwgJ0Nhc3QnOnJlc3VsdGFkb1snYXRvcmVzJ10uc3BsaXQoJywnKSwgJ1RyYWlsZXInOiByZXN1bHRhZG9bJ3RyYWlsZXInXSwgJ0RpcmVjdG9yJzogcmVzdWx0YWRvWydkaXJldG9yJ10sICdSYXRpbmcnOiByZXN1bHRhZG9bJ2ltZGJSYXRpbmcnXSwgJ0lNREJOdW1iZXInOiByZXN1bHRhZG9bJ0lNQkQnXSB9DQoJCQlub21lZWUgPSAnW0NPTE9SICcrY29yKyddJytwdCticityZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK3Jlc3VsdGFkb1snYW5vJ10rJylbL0NPTE9SXScNCgkJCXVybG5vbyA9IF9fQVBJX1NJVEVfXysnZmlsbWUvJytzdHIocmVzdWx0YWRvWydpZF92aWRlbyddKQ0KCQkJDQoJCQlmb3Rvb28gPSByZXN1bHRhZG9bJ2ZvdG8nXQ0KCQkJI2ZvdG9vbyA9IGZvdG9vby5yZXBsYWNlKCdQVCcsJycpDQoJCQkjcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10gPSByZXN1bHRhZG9bJ2JhY2tncm91bmQnXS5yZXBsYWNlKCdQVCcsJycpDQoJCQlyZXN1bHRhZG9bJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK3Jlc3VsdGFkb1snSU1CRCddKycuanBnJw0KCQkJZmFuYXJ0dHQgPSBfX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddDQoJCQkNCgkJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTMsIGZvdG9vbyx2aXN0bywgJ3BsYXllcicsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPXJlc3VsdGFkb1sndHJhaWxlciddKQ0KCQllbGlmICdzZXJpZScgaW4gdXJsIG9yICdhbmltZScgaW4gdXJsOg0KCQkJY29yID0gIndoaXRlIg0KCQkJaWYgJ3NlcmllJyBpbiB1cmw6DQoJCQkJdGlwbyA9ICdzZXJpZScNCgkJCWVsaWYgJ2FuaW1lJyBpbiB1cmw6DQoJCQkJdGlwbyA9ICdhbmltZScNCgkJCXJlc3VsdGFkbyA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rdGlwbysnLycrc3RyKGlbJ2lkX3ZpZGVvJ10pLCBoZWFkZXI9aGVhZGVycykNCgkJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQ0KCQkJY2F0ZWdvcmlhID0gcmVzdWx0YWRvWydjYXRlZ29yaWExJ10NCgkJCWlmIHJlc3VsdGFkb1snY2F0ZWdvcmlhMiddICE9ICcnOg0KCQkJCWNhdGVnb3JpYSArPSAnLCcrcmVzdWx0YWRvWydjYXRlZ29yaWEyJ10NCgkJCWlmIHJlc3VsdGFkb1snY2F0ZWdvcmlhMyddICE9ICcnOg0KCQkJCWNhdGVnb3JpYSArPSAnLCcrcmVzdWx0YWRvWydjYXRlZ29yaWEzJ10NCgkJCXB0ID0gJycNCgkJCWJyID0gJycNCgkJCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6DQoJCQkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJw0KCQkJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6DQoJCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQkJaWYgJ1BUJyBpbiByZXN1bHRhZG9bJ0lNQkQnXToNCgkJCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nDQoJCQl0cnk6DQoJCQkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykNCgkJCWV4Y2VwdDoNCgkJCQlub21lID0gcmVzdWx0YWRvWydub21lX2luZ2xlcyddLmVuY29kZSgndXRmLTgnKQ0KCQkJaWYgJ2h0dHAnIG5vdCBpbiByZXN1bHRhZG9bJ2ZvdG8nXToNCgkJCQlyZXN1bHRhZG9bJ2ZvdG8nXSA9IF9fQVBJX1NJVEVfXysnaW1hZ2VzL2NhcGFzLycrcmVzdWx0YWRvWydmb3RvJ10uc3BsaXQoJy8nKVstMV0NCgkJCXZpc3RvID0gRmFsc2UNCgkJCWlmIHJlc3VsdGFkb1sndmlzdG8nXSA9PSAxOg0KCQkJCXZpc3RvPVRydWUNCgkJCQ0KCQkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogcmVzdWx0YWRvWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IHJlc3VsdGFkb1snZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzpyZXN1bHRhZG9bJ2F0b3JlcyddLnNwbGl0KCcsJyksICdUcmFpbGVyJzogcmVzdWx0YWRvWyd0cmFpbGVyJ10sICdEaXJlY3Rvcic6IHJlc3VsdGFkb1snZGlyZXRvciddLCAnUmF0aW5nJzogcmVzdWx0YWRvWydpbWRiUmF0aW5nJ10sICdDb2RlJzogcmVzdWx0YWRvWydJTUJEJ10gfQ0KCQkJDQoJCQlmb3Rvb28gPSByZXN1bHRhZG9bJ2ZvdG8nXQ0KCQkJI2ZvdG9vbyA9IGZvdG9vby5yZXBsYWNlKCdQVCcsJycpDQoJCQkjcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10gPSByZXN1bHRhZG9bJ2JhY2tncm91bmQnXS5yZXBsYWNlKCdQVCcsJycpDQoJCQlyZXN1bHRhZG9bJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK3Jlc3VsdGFkb1snSU1CRCddKycuanBnJw0KCQkJZmFuYXJ0dHQgPSBfX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddDQoJCQkNCgkJCW5vbWVlZSA9IHB0K2JyK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcrcmVzdWx0YWRvWydhbm8nXSsnKScNCgkJCWFkZERpcjIobm9tZWVlLCBfX0FQSV9TSVRFX18rdGlwbysnLycrc3RyKHJlc3VsdGFkb1snaWRfdmlkZW8nXSksIDExNCwgJ3RlbXBvcmFkYXMnLCBmb3Rvb28sIHRpcG89J3NlcmllJywgaW5mb0xhYmVscz1pbmZvTGFiZWxzLHBvc3Rlcj1mYW5hcnR0dCx2aXN0bz12aXN0bykNCgkNCgljdXJyZW50ID0gcmVzdWx0YWRvYVsnbWV0YSddWydwYWdpbmF0aW9uJ11bJ2N1cnJlbnRfcGFnZSddDQoJdG90YWwgPSByZXN1bHRhZG9hWydtZXRhJ11bJ3BhZ2luYXRpb24nXVsndG90YWxfcGFnZXMnXQ0KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb2FbJ21ldGEnXVsncGFnaW5hdGlvbiddWydsaW5rcyddWyduZXh0J10NCglleGNlcHQ6IHBhc3MgDQoJaWYgY3VycmVudCA8IHRvdGFsOg0KCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyMSwgJ2Fub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQ0KCQ0KCXZpc3RhX2ZpbG1lc1NlcmllcygpDQoNCmRlZiBnZXRZZWFycyh1cmwpOg0KCWFub3MgPSBbDQoJCQknMjAxNycsDQoJCQknMjAxNicsDQoJCQknMjAxNScsDQoJCQknMjAxNCcsDQoJCQknMjAxMycsDQoJCQknMjAxMicsDQoJCQknMjAxMScsDQoJCQknMjAxMCcsDQoJCQknMjAwOScsDQoJCQknMjAwOCcsDQoJCQknMjAwNycsDQoJCQknMjAwNicsDQoJCQknMjAwMC0yMDA1JywNCgkJCScxOTkwLTE5OTknLA0KCQkJJzE5ODAtMTk4OScsDQoJCQknMTk3MC0xOTc5JywNCgkJCScxOTYwLTE5NjknLA0KCQkJJzE5NTAtMTk1OScsDQoJCQknMTkwMC0xOTQ5Jw0KCQldDQoJZm9yIGkgaW4gYW5vczoNCgkJYWRkRGlyMihpLCB1cmwrJy8nK2ksIDEyMSwgJ2Fub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3ZpZC5wbmcnKSkNCgkJDQoJdmlzdGFfbWVudSgpDQoNCmRlZiBhbm9zKHVybCk6DQoJaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpDQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMpDQoJaWYgcmVzdWx0YWRvID09ICdETlMnOg0KCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBhZGRvbi4nKQ0KCQlyZXR1cm4gRmFsc2UNCglyZXN1bHRhZG9hID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pDQoJDQoJZm9yIGkgaW4gcmVzdWx0YWRvYVsiZGF0YSJdOg0KCQlpZiAnZmlsbWUnIGluIHVybDoNCgkJCXJlc3VsdGFkbyA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2ZpbG1lLycrc3RyKGlbJ2lkX3ZpZGVvJ10pLCBoZWFkZXI9aGVhZGVycykNCgkJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQ0KCQkJY2F0ZWdvcmlhID0gcmVzdWx0YWRvWydjYXRlZ29yaWExJ10NCgkJCWlmIHJlc3VsdGFkb1snY2F0ZWdvcmlhMiddICE9ICcnOg0KCQkJCWNhdGVnb3JpYSArPSAnLCcrcmVzdWx0YWRvWydjYXRlZ29yaWEyJ10NCgkJCWlmIHJlc3VsdGFkb1snY2F0ZWdvcmlhMyddICE9ICcnOg0KCQkJCWNhdGVnb3JpYSArPSAnLCcrcmVzdWx0YWRvWydjYXRlZ29yaWEzJ10NCgkJCQ0KCQkJdmlzdG8gPSBGYWxzZQ0KCQkJcHQgPSAnJw0KCQkJYnIgPSAnJw0KCQkJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToNCgkJCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nDQoJCQlpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToNCgkJCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nDQoJCQljb3IgPSAid2hpdGUiDQoJCQlpZiAnUFQnIGluIGlbJ0lNQkQnXToNCgkJCQlpWydJTUJEJ10gPSByZS5jb21waWxlKCcoLis/KVBUJykuZmluZGFsbChpWydJTUJEJ10pWzBdDQoJCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQkJaWYgaVsndmlzdG8nXSA9PSAxOg0KCQkJCXZpc3RvID0gVHJ1ZQ0KCQkJDQoJCQl0cnk6DQoJCQkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykNCgkJCWV4Y2VwdDoNCgkJCQlub21lID0gcmVzdWx0YWRvWydub21lX2luZ2xlcyddLmVuY29kZSgndXRmLTgnKQ0KCQkJaWYgJ2h0dHAnIG5vdCBpbiByZXN1bHRhZG9bJ2ZvdG8nXToNCgkJCQlyZXN1bHRhZG9bJ2ZvdG8nXSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK3Jlc3VsdGFkb1snZm90byddLnNwbGl0KCcvJylbLTFdDQoJDQoJCQlpbmZvTGFiZWxzID0geydUaXRsZSc6IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXSwgJ1llYXInOiByZXN1bHRhZG9bJ2FubyddLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzpyZXN1bHRhZG9bJ2Rlc2NyaWNhb192aWRlbyddLCAnQ2FzdCc6cmVzdWx0YWRvWydhdG9yZXMnXS5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IHJlc3VsdGFkb1sndHJhaWxlciddLCAnRGlyZWN0b3InOiByZXN1bHRhZG9bJ2RpcmV0b3InXSwgJ1JhdGluZyc6IHJlc3VsdGFkb1snaW1kYlJhdGluZyddLCAnSU1EQk51bWJlcic6IHJlc3VsdGFkb1snSU1CRCddIH0NCgkJCW5vbWVlZSA9ICdbQ09MT1IgJytjb3IrJ10nK3B0K2JyK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJylbL0NPTE9SXScNCgkJCXVybG5vbyA9IF9fQVBJX1NJVEVfXysnZmlsbWUvJytzdHIocmVzdWx0YWRvWydpZF92aWRlbyddKQ0KCQkJDQoJCQlmb3Rvb28gPSByZXN1bHRhZG9bJ2ZvdG8nXQ0KCQkJZm90b29vID0gZm90b29vLnJlcGxhY2UoJ1BUJywnJykNCgkJCXJlc3VsdGFkb1snYmFja2dyb3VuZCddID0gcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQ0KCQkJZmFuYXJ0dHQgPSBfX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddDQoJCQkNCgkJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTMsIGZvdG9vbyx2aXN0bywgJ3BsYXllcicsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPXJlc3VsdGFkb1sndHJhaWxlciddKQ0KCQllbGlmICdzZXJpZScgaW4gdXJsIG9yICdhbmltZScgaW4gdXJsOg0KCQkJY29yID0gIndoaXRlIg0KCQkJaWYgJ3NlcmllJyBpbiB1cmw6DQoJCQkJdGlwbyA9ICdzZXJpZScNCgkJCWVsaWYgJ2FuaW1lJyBpbiB1cmw6DQoJCQkJdGlwbyA9ICdhbmltZScNCgkJCXJlc3VsdGFkbyA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rdGlwbysnLycrc3RyKGlbJ2lkX3ZpZGVvJ10pLCBoZWFkZXI9aGVhZGVycykNCgkJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQ0KCQkJY2F0ZWdvcmlhID0gcmVzdWx0YWRvWydjYXRlZ29yaWExJ10NCgkJCWlmIHJlc3VsdGFkb1snY2F0ZWdvcmlhMiddICE9ICcnOg0KCQkJCWNhdGVnb3JpYSArPSAnLCcrcmVzdWx0YWRvWydjYXRlZ29yaWEyJ10NCgkJCWlmIHJlc3VsdGFkb1snY2F0ZWdvcmlhMyddICE9ICcnOg0KCQkJCWNhdGVnb3JpYSArPSAnLCcrcmVzdWx0YWRvWydjYXRlZ29yaWEzJ10NCgkJCXB0PScnDQoJCQliciA9ICcnDQoJCQlpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOg0KCQkJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScNCgkJCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOg0KCQkJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScNCgkJCWlmICdQVCcgaW4gcmVzdWx0YWRvWydJTUJEJ106DQoJCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQkJdHJ5Og0KCQkJCW5vbWUgPSByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10uZGVjb2RlKCd1dGYtOCcpDQoJCQlleGNlcHQ6DQoJCQkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXS5lbmNvZGUoJ3V0Zi04JykNCgkJCWlmICdodHRwJyBub3QgaW4gcmVzdWx0YWRvWydmb3RvJ106DQoJCQkJcmVzdWx0YWRvWydmb3RvJ10gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytyZXN1bHRhZG9bJ2ZvdG8nXS5zcGxpdCgnLycpWy0xXQ0KCQkJaWYgcmVzdWx0YWRvWyd2aXN0byddID09IDE6DQoJCQkJdmlzdG89VHJ1ZQ0KCQkJZWxzZToNCgkJCQl2aXN0bz1GYWxzZQ0KCQkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogcmVzdWx0YWRvWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IHJlc3VsdGFkb1snZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzpyZXN1bHRhZG9bJ2F0b3JlcyddLnNwbGl0KCcsJyksICdUcmFpbGVyJzogcmVzdWx0YWRvWyd0cmFpbGVyJ10sICdEaXJlY3Rvcic6IHJlc3VsdGFkb1snZGlyZXRvciddLCAnUmF0aW5nJzogcmVzdWx0YWRvWydpbWRiUmF0aW5nJ10sICdDb2RlJzogcmVzdWx0YWRvWydJTUJEJ10gfQ0KCQkJDQoJCQlmb3Rvb28gPSByZXN1bHRhZG9bJ2ZvdG8nXQ0KCQkJZm90b29vID0gZm90b29vLnJlcGxhY2UoJ1BUJywnJykNCgkJCXJlc3VsdGFkb1snYmFja2dyb3VuZCddID0gcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQ0KCQkJZmFuYXJ0dHQgPSBfX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddDQoJCQkNCgkJCW5vbWVlZSA9IHB0K2JyK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJyknDQoJCQlhZGREaXIyKG5vbWVlZSwgX19BUElfU0lURV9fK3RpcG8rJy8nK3N0cihyZXN1bHRhZG9bJ2lkX3ZpZGVvJ10pLCAxMTQsICd0ZW1wb3JhZGFzJywgZm90b29vLCB0aXBvPSdzZXJpZScsIGluZm9MYWJlbHM9aW5mb0xhYmVscyxwb3N0ZXI9ZmFuYXJ0dHQsdmlzdG89dmlzdG8pDQoJDQoJY3VycmVudCA9IHJlc3VsdGFkb2FbJ21ldGEnXVsncGFnaW5hdGlvbiddWydjdXJyZW50X3BhZ2UnXQ0KCXRvdGFsID0gcmVzdWx0YWRvYVsnbWV0YSddWydwYWdpbmF0aW9uJ11bJ3RvdGFsX3BhZ2VzJ10NCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9hWydtZXRhJ11bJ3BhZ2luYXRpb24nXVsnbGlua3MnXVsnbmV4dCddDQoJZXhjZXB0OiBwYXNzIA0KCWlmIGN1cnJlbnQgPCB0b3RhbDoNCgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjEsICdhbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJyksMSkNCgkNCgl2aXN0YV9maWxtZXNTZXJpZXMoKQ0KDQpkZWYgZ2V0RXZlbnRvcygpOg0KCWhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQ0KCQ0KCXJlc3VsdGFkbyA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2V2ZW50b3MnLCBoZWFkZXI9aGVhZGVycykNCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykNCgl0cnk6DQoJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0Og0KCQkJcmV0dXJuIEZhbHNlDQoJZXhjZXB0Og0KCQlwYXNzDQoJcmV0dXJuIHJlc3VsdGFkb1snZGF0YSddWydub21lJ10NCgkJDQoJCQ0KZGVmIHBsYXllcihuYW1lLHVybCxpY29uaW1hZ2UsdGVtcG9yYWRhLGVwaXNvZGlvLHNlcmllTm9tZSk6DQoJaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpDQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMpDQoJaWYgcmVzdWx0YWRvID09ICdETlMnOg0KCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBhZGRvbi4nKQ0KCQlyZXR1cm4gRmFsc2UNCgkNCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykNCglpbmZvbGFiZWxzID0gZGljdCgpDQoNCglwYXN0YURhdGEgPSAnJw0KCWlmICdmaWxtZScgaW4gdXJsOg0KCQlpbmZvbGFiZWxzWydDb2RlJ10gPSByZXN1bHRhZG9bJ0lNQkQnXQ0KCQlpbmZvbGFiZWxzWydZZWFyJ10gPSByZXN1bHRhZG9bJ2FubyddDQoJCWlkVmlkZW8gPSByZXN1bHRhZG9bJ2lkX3ZpZGVvJ10NCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXQ0KCQl0ZW1wb3JhZGEgPSAwDQoJCWVwaXNvZGlvID0gMA0KCWVsc2U6DQoJCWlkVmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10NCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddDQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10NCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10NCg0KCW1lbnNhZ2VtcHJvZ3Jlc3NvID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpDQoJbWVuc2FnZW1wcm9ncmVzc28uY3JlYXRlKEFkZG9uVGl0bGUsIHUnQWJyaXIgZW1pc3PDo28nLCdQb3IgZmF2b3IgYWd1YXJkZS4uLicpDQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbyBlIGxlZ2VuZGEnLCAiIikNCg0KCXN0cmVhbSwgbGVnZW5kYSwgZXh0X2cgPSBnZXRTdHJlYW1MZWdlbmRhKHJlc3VsdGFkbykNCg0KCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg1MCwgIiIsIHUnUHJlcGFyYS10ZSwgdmFpIGNvbWXDp2FyIScsICIiKQ0KDQoJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KDEpDQoJcGxheWxpc3QuY2xlYXIoKQ0KCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9IkRlZmF1bHRWaWRlby5wbmciLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpDQoNCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvbGFiZWxzKQ0KCWxpc3RpdGVtLnNldFByb3BlcnR5KCdtaW1ldHlwZScsICd2aWRlby94LW1zdmlkZW8nKQ0KCWxpc3RpdGVtLnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQ0KCQ0KCWxpc3RpdGVtLnNldFBhdGgocGF0aD1zdHJlYW0pDQoJcGxheWxpc3QuYWRkKHN0cmVhbSwgbGlzdGl0ZW0pDQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkNCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNzUsICIiLCB1J0JvYSBTZXNzw6NvISEhJywgIiIpDQoNCglpZiBzdHJlYW0gPT0gRmFsc2U6DQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ08gc2Vydmlkb3IgZXNjb2xoaWRvIG7Do28gZGlzcG9uw612ZWwsIGVzY29saGEgb3V0cm8gb3UgdGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykNCgllbHNlOg0KCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnU3RyZWFtOiAnK3N0cmVhbSkNCgkJcGxheWVyX21yID0gUGxheWVyLlBsYXllcih1cmw9dXJsLCBpZEZpbG1lPWlkVmlkZW8sIHBhc3RhRGF0YT1fX1BBU1RBX0RBRE9TX18sIHRlbXBvcmFkYT10ZW1wb3JhZGEsIGVwaXNvZGlvPWVwaXNvZGlvLCBub21lPW5hbWUsIGxvZ289b3MucGF0aC5qb2luKF9fQURET05fRk9MREVSX18sJ2ljb24ucG5nJykpDQoJCQ0KCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpDQoJCXBsYXllcl9tci5wbGF5KHBsYXlsaXN0KQ0KCQlwbGF5ZXJfbXIuc2V0U3VidGl0bGVzKGxlZ2VuZGEpDQoNCgkJd2hpbGUgcGxheWVyX21yLnBsYXlpbmc6DQoJCQl4Ym1jLnNsZWVwKDUwMDApDQoJCQkjcGxheWVyX21yLnRyYWNrZXJUZW1wbygpDQoNCmRlZiBnZXRTdHJlYW1MZWdlbmRhKHJlc3VsdGFkbyk6DQoJaSA9IDANCglzZXJ2aWRvcmVzID0gW10NCgl0aXR1bG9zID0gW10NCglpZiByZXN1bHRhZG9bJ1VSTCddICE9ICcnOg0KCQlpKz0xDQoJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pDQoJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkwnXToNCgkJCW5vbWUgPSAiT3BlbkxvYWQiDQoJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTCddOg0KCQkJbm9tZSA9ICdWaWR6aScNCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTCddOg0KCQkJbm9tZSA9IEFkZG9uVGl0bGUNCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMJ106DQoJCQlub21lID0gJ1VwVG9TdHJlYW0nDQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwnXToNCgkJCW5vbWUgPSAnUmFwaWRWaWRlbycNCgkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQ0KCWlmIHJlc3VsdGFkb1snVVJMMiddICE9ICcnOg0KCQlpKz0xDQoJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQ0KCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMMiddOg0KCQkJbm9tZSA9ICJPcGVuTG9hZCINCgkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMMiddOg0KCQkJbm9tZSA9ICdWaWR6aScNCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDInXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkwyJ106DQoJCQlub21lID0gQWRkb25UaXRsZQ0KCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkwyJ106DQoJCQlub21lID0gJ1VwVG9TdHJlYW0nDQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDInXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMMiddOg0KCQkJbm9tZSA9ICdSYXBpZFZpZGVvJw0KCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpDQoJdHJ5Og0KCQlpZiByZXN1bHRhZG9bJ1VSTDMnXSAhPSAnJzoNCgkJCWkrPTENCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQ0KCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDMnXToNCgkJCQlub21lID0gIk9wZW5Mb2FkIg0KCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMMyddOg0KCQkJCW5vbWUgPSAnVmlkemknDQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMMyddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDMnXToNCgkJCQlub21lID0gQWRkb25UaXRsZQ0KCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMMyddOg0KCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScNCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDMnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMMyddOg0KCQkJCW5vbWUgPSAnUmFwaWRWaWRlbycNCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkNCglleGNlcHQ6DQoJCXBhc3MNCgl0cnk6DQoJCWlmIHJlc3VsdGFkb1snVVJMNCddICE9ICcnOg0KCQkJaSs9MQ0KCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pDQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMNCddOg0KCQkJCW5vbWUgPSAiT3BlbkxvYWQiDQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkw0J106DQoJCQkJbm9tZSA9ICdWaWR6aScNCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkw0J10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMNCddOg0KCQkJCW5vbWUgPSBBZGRvblRpdGxlDQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkw0J106DQoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJw0KCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMNCddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkw0J106DQoJCQkJbm9tZSA9ICdSYXBpZFZpZGVvJw0KCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQ0KCWV4Y2VwdDoNCgkJcGFzcw0KCWxlZ2VuZGEgPSAnJw0KCXN0cmVhbSA9ICcnDQoJaWYgJzovLycgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ10gb3IgcmVzdWx0YWRvWydsZWdlbmRhJ10gPT0gJyc6DQoJCWxlZ2VuZGEgPSBfX0FQSV9fKydzdWJzLyVzLnNydCcgJSByZXN1bHRhZG9bJ0lNQkQnXQ0KCWVsaWYgcmVzdWx0YWRvWydsZWdlbmRhJ10gIT0gJyc6DQoJCWlmIG5vdCAnLnNydCcgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ106DQoJCQlyZXN1bHRhZG9bJ2xlZ2VuZGEnXSA9IHJlc3VsdGFkb1snbGVnZW5kYSddKycuc3J0Jw0KCQlsZWdlbmRhID0gX19BUElfXysnc3Vicy8lcycgJSByZXN1bHRhZG9bJ2xlZ2VuZGEnXQ0KCXRyeToNCgkJaWYgcmVzdWx0YWRvWydzZW1sZWdlbmRhJ10gPT0gMToNCgkJCWxlZ2VuZGEgPSAnJw0KCWV4Y2VwdDoNCgkJcGFzcw0KCWV4dF9nID0gJ2NvaXNvJw0KCWxlZ2VuZGFBdXggPSBsZWdlbmRhDQoJc2Vydmlkb3IgPSAwDQoJaWYgbGVuKHRpdHVsb3MpID4gMToNCgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykNCgllbHNlOg0KCQlzZXJ2aWRvciA9IDANCgkNCglpZiAndmlkemknIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOg0KCQl2aWR6aSA9IFVSTFJlc29sdmVyTWVkaWEuVmlkemkoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pDQoJCXN0cmVhbSA9IHZpZHppLmdldE1lZGlhVXJsKCkNCgkJbGVnZW5kYSA9IHZpZHppLmdldFN1YnRpdGxlKCkNCgllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06DQoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuVXBUb1N0cmVhbShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQ0KCWVsaWYgJ3NlcnZlci5tcnBpcmFjeS53aW4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOg0KCQlzdHJlYW0gPSBzZXJ2aWRvcmVzW3NlcnZpZG9yXQ0KCWVsaWYgJ29wZW5sb2FkJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToNCgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQ0KCQlsZWdlbmRhID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0U3VidGl0bGUoKQ0KCQlpZiBub3QgJy52dHQnIGluIGxlZ2VuZGE6DQoJCQlsZWdlbmRhID0gbGVnZW5kYUF1eA0KCWVsaWYgJ2RyaXZlLmdvb2dsZS5jb20vJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToNCgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuR29vZ2xlVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkNCgllbGlmICdjbG91ZC5tYWlsLnJ1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToNCgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuQ2xvdWRNYWlsUnUoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkNCgllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0gb3IgJ3JhcHR1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToNCgkJcmFwaWQgPSBVUkxSZXNvbHZlck1lZGlhLlJhcGlkVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pDQoJCXN0cmVhbSA9IHJhcGlkLmdldE1lZGlhVXJsKCkNCgkJbGVnZW5kYSA9IHJhcGlkLmdldExlZ2VuZGEoKQ0KCQ0KCXJldHVybiBzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nDQoNCg0KZGVmIHBlc3F1aXNhKHVybCk6DQoJY29kaWdvX2ZvbnRlID0gJycNCglkYWRvcyA9ICcnDQoJbmV0ID0gTmV0KCkNCgluZXQuc2V0X2Nvb2tpZXMoX19DT09LSUVfRklMRV9fKQ0KCWhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQ0KCXRhYmVsYSA9ICcnDQoJc3RyUGVzcXVpc2EgPSAnJw0KCWZpY2hlaXJvID0gJycNCglpZiAnZmlsbWVzJyBpbiB1cmw6DQoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZmlsbWVzX3Blc3F1aXNhLmxpdmVpdCcpDQoJCXRpcG8gPSAwDQoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6DQoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpDQoJCXRpcG8gPSAxDQoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6DQoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5pbWVzX3Blc3F1aXNhLmxpdmVpdCcpDQoJCXRpcG8gPSAyDQoJDQoJaWYgJ3BhZ2UnIG5vdCBpbiB1cmw6DQoJCSN0aXBvID0geGJtY2d1aS5EaWFsb2coKS5zZWxlY3QodSdPbmRlIHF1ZXIgcGVzcXVpc2FyPycsIFsnRmlsbWVzJywgJ1NlcmllcycsICdBbmltZXMnLCAnQ2FuYWlzJywgJ1ByYWlhcycsICdSw6FkaW9zJ10pDQoJCXRpcG8gPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCh1J09uZGUgcXVlciBwZXNxdWlzYXI/JywgWydGaWxtZXMnLCAnU2VyaWVzJywgJ0FuaW1lcyddKQ0KCQl0ZWNsYWRvID0geGJtYy5LZXlib2FyZCgnJywgJ08gcXVlIHF1ZXIgcGVzcXVpc2FyPycpDQoJCWlmIHRpcG8gPT0gMDoNCgkJCXVybCA9IF9fQVBJX1NJVEVfXysnZmlsbWVzL3Blc3F1aXNhJw0KCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykNCgkJZWxpZiB0aXBvID09IDE6DQoJCQl1cmwgPSBfX0FQSV9TSVRFX18rJ3Nlcmllcy9wZXNxdWlzYScNCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpDQoJCWVsaWYgdGlwbyA9PSAyOg0KCQkJdXJsID0gX19BUElfU0lURV9fKydhbmltZXMvcGVzcXVpc2EnDQoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2FuaW1lc19wZXNxdWlzYS5saXZlaXQnKQ0KCQllbGlmIHRpcG8gPT0gMyBvciAgdGlwbyA9PSA0IG9yIHRpcG8gPT0gNToNCgkJCXVybCA9IF9fU0lURUJEX18rJ3NlYXJjaC5waHAnDQoJCQlpZiB0aXBvID09IDM6DQoJCQkJdGFiZWxhID0gJ2NhbmFpc19rb2RpJw0KCQkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2FuYWlzLmxpdmVpdCcpDQoJCQllbGlmIHRpcG8gPT0gNDoNCgkJCQl0YWJlbGEgPSAncHJhaWFzX2tvZGknDQoJCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcmFpYXMubGl2ZWl0JykNCgkJCWVsaWYgdGlwbyA9PSA1Og0KCQkJCXRhYmVsYSA9ICdyYWRpb3Nfa29kaScNCgkJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3JhZGlvcy5saXZlaXQnKQ0KCQkJZWxzZToNCgkJCQl0YWJlbGEgPSAncHJvZ3JhbWFzX2tvZGknDQoJCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcm9ncmFtYXMubGl2ZWl0JykNCgkJDQoJCWlmIGZpY2hlaXJvICE9ICcnOg0KCQkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOg0KCQkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpDQoJCQkJdGV4dG8gPSBmLnJlYWQoKQ0KCQkJCXRlY2xhZG8uc2V0RGVmYXVsdCh0ZXh0bykNCgkJCXRlY2xhZG8uZG9Nb2RhbCgpDQoNCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOg0KCQkJc3RyUGVzcXVpc2EgPSB0ZWNsYWRvLmdldFRleHQoKQ0KCQkJZGFkb3MgPSB7J3Blc3F1aXNhJzogc3RyUGVzcXVpc2F9DQoJCQl0cnk6DQoJCQkJZiA9IG9wZW4oZmljaGVpcm8sIG1vZGU9InciKQ0KCQkJCWYud3JpdGUoc3RyUGVzcXVpc2EpDQoJCQkJZi5jbG9zZSgpDQoJCQlleGNlcHQ6DQoJCQkJdHJhY2ViYWNrLnByaW50X2V4YygpDQoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBncmF2b3UgbyBjb250ZXVkbyBlbSAnK2ZpY2hlaXJvKQ0KCQkJDQoJCQlpZiBzdHJQZXNxdWlzYSA9PSAnJzoNCgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQ0KCQkJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCAndXJsJywgNzAwMCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkNCgkJCWVsc2U6DQoJCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWpzb24uZHVtcHMoZGFkb3MpLCBoZWFkZXI9aGVhZGVycykNCgllbHNlOg0KCQlpZiBmaWNoZWlybyAhPSAnJzoNCgkJCWlmIHhibWN2ZnMuZXhpc3RzKGZpY2hlaXJvKToNCgkJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQ0KCQkJCXRleHRvID0gZi5yZWFkKCkNCgkJCWRhZG9zID0geydwZXNxdWlzYSc6IHRleHRvfQ0KCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWpzb24uZHVtcHMoZGFkb3MpLCBoZWFkZXI9aGVhZGVycykNCgkNCglpZiBzdHJQZXNxdWlzYSAhPSAnJzoNCgkJaWYgcmVzdWx0YWRvID09ICdETlMnOg0KCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gYWRkb24uJykNCgkJCXJldHVybiBGYWxzZQ0KCQkNCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pDQoJCWlmIHJlc3VsdGFkb1snZGF0YSddICE9ICcnOg0KCQkJaWYgdGlwbyA9PSAwOg0KCQkJCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOg0KCQkJCQljYXRlZ29yaWEgPSBpWydjYXRlZ29yaWExJ10NCgkJCQkJaWYgaVsnY2F0ZWdvcmlhMiddICE9ICcnOg0KCQkJCQkJY2F0ZWdvcmlhICs9ICcsJytpWydjYXRlZ29yaWEyJ10NCgkJCQkJaWYgaVsnY2F0ZWdvcmlhMyddICE9ICcnOg0KCQkJCQkJY2F0ZWdvcmlhICs9ICcsJytpWydjYXRlZ29yaWEzJ10NCgkJCQkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBpWydub21lX2luZ2xlcyddLCAnWWVhcic6IGlbJ2FubyddLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzogaVsnZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzppWydhdG9yZXMnXS5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IGlbJ3RyYWlsZXInXSwgJ0RpcmVjdG9yJzogaVsnZGlyZXRvciddLCAnUmF0aW5nJzogaVsnaW1kYlJhdGluZyddLCAnSU1EQk51bWJlcic6IGlbJ0lNQkQnXSB9CQkJCQ0KCQkJCQl0cnk6DQoJCQkJCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykNCgkJCQkJZXhjZXB0Og0KCQkJCQkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpDQoJCQkJCXB0ID0gJycNCgkJCQkJYnIgPSAnJw0KCQkJCQlpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOg0KCQkJCQkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJw0KCQkJCQlpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToNCgkJCQkJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScNCgkJCQkJY29yID0gIndoaXRlIg0KCQkJCQlpZiAnaHR0cCcgbm90IGluIGlbJ2ZvdG8nXToNCgkJCQkJCWlbJ2ZvdG8nXSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ZvdG8nXS5zcGxpdCgnLycpWy0xXQ0KCQkJCQlpZiAnUFQnIGluIGlbJ0lNQkQnXToNCgkJCQkJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0NCgkJCQkJCXB0ID0gJ1tCXVBUOiBbL0JdJw0KCQkJCQl2aXN0byA9IEZhbHNlDQoJCQkJCQ0KCQkJCQlub21lZWUgPSBwdCtyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2lbJ2FubyddKycpJw0KCQkJCQl1cmxub28gPSBfX0FQSV9TSVRFX18rJ2ZpbG1lLycrc3RyKGlbJ2lkX3ZpZGVvJ10pDQoJCQkJCWZvdG9vbyA9IGlbJ2ZvdG8nXQ0KCQkJCQlmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddDQoJCQkJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTMsIGZvdG9vbyx2aXN0bywgJ2ZpbG1lJywgMCwgMCwgaW5mb0xhYmVscywgZmFuYXJ0dHQsIHRyYWlsZXI9aVsndHJhaWxlciddKQ0KCQkJZWxpZiB0aXBvID09IDEgb3IgdGlwbyA9PSAyOg0KCQkJCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOg0KCQkJCQljYXRlZ29yaWEgPSBpWydjYXRlZ29yaWExJ10NCgkJCQkJaWYgaVsnY2F0ZWdvcmlhMiddICE9ICcnOg0KCQkJCQkJY2F0ZWdvcmlhICs9ICcsJytpWydjYXRlZ29yaWEyJ10NCgkJCQkJaWYgaVsnY2F0ZWdvcmlhMyddICE9ICcnOg0KCQkJCQkJY2F0ZWdvcmlhICs9ICcsJytpWydjYXRlZ29yaWEzJ10NCgkJCQkJcHQgPSAnJw0KCQkJCQliciA9ICcnDQoJCQkJCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6DQoJCQkJCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nDQoJCQkJCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOg0KCQkJCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJw0KCQkJCQlpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogaVsnYW5vJ10sICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBpWydkZXNjcmljYW9fdmlkZW8nXSwgJ0Nhc3QnOmlbJ2F0b3JlcyddLnNwbGl0KCcsJyksICdUcmFpbGVyJzogaVsndHJhaWxlciddLCAnRGlyZWN0b3InOiBpWydkaXJldG9yJ10sICdSYXRpbmcnOiBpWydpbWRiUmF0aW5nJ10sICdDb2RlJzogaVsnSU1CRCddIH0NCgkJCQkJY29yID0gIndoaXRlIg0KCQkJCQlpZiAnUFQnIGluIGlbJ0lNQkQnXToNCgkJCQkJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0NCgkJCQkJCXB0ID0gJ1tCXVBUOiBbL0JdJw0KCQkJCQl0cnk6DQoJCQkJCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykNCgkJCQkJZXhjZXB0Og0KCQkJCQkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpDQoJCQkJCWlmICdodHRwJyBub3QgaW4gaVsnZm90byddOg0KCQkJCQkJaVsnZm90byddID1fX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydmb3RvJ10uc3BsaXQoJy8nKVstMV0NCgkJCQkJaWYgdGlwbyA9PSAxOg0KCQkJCQkJbGluayA9ICdzZXJpZScNCgkJCQkJZWxpZiB0aXBvID09IDI6DQoJCQkJCQlsaW5rID0gJ2FuaW1lJw0KCQkJCQl2aXN0bz1GYWxzZQkNCgkJCQkJbm9tZWVlID0gcHQrcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJytpWydhbm8nXSsnKScNCgkJCQkJdXJsbm9vID0gX19BUElfU0lURV9fK2xpbmsrJy8nK3N0cihpWydpZF92aWRlbyddKQ0KCQkJCQlmb3Rvb28gPSBpWydmb3RvJ10NCgkJCQkJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQ0KCQkJCQlhZGREaXIyKG5vbWVlZSwgdXJsbm9vLCAxMTQsICd0ZW1wb3JhZGFzJywgZm90b29vLCB0aXBvPSdzZXJpZScsIGluZm9MYWJlbHM9aW5mb0xhYmVscyxwb3N0ZXI9ZmFuYXJ0dHQsdmlzdG89dmlzdG8pDQoNCgkJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hdGlvbiddWydjdXJyZW50X3BhZ2UnXQ0KCQkJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hdGlvbiddWyd0b3RhbF9wYWdlcyddDQoJCQl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hdGlvbiddWydsaW5rcyddWyduZXh0J10NCgkJCWV4Y2VwdDogcGFzcyANCgkJCWlmIGN1cnJlbnQgPCB0b3RhbDoNCgkJCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjAsICdwZXNxdWlzYScsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQ0KCQkJZWxzZToNCgkJCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpDQoJCQl2aXN0YV9maWxtZXNTZXJpZXMoKQ0KCQkJDQoNCg0KZGVmIGRvd25sb2FkKHVybCxuYW1lLCB0ZW1wb3JhZGEsZXBpc29kaW8sc2VyaWVOb21lKToNCgloZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykNCglsaW5rcyA9IHVybC5zcGxpdCgnLycpDQoJaWYgJ2ZpbG1lJyBpbiB1cmw6DQoJCWlkX3ZpZGVvID0gbGlua3NbLTFdDQoJCXRpcG8gPSAwDQoJZWxpZiAnc2VyaWUnIGluIHVybDoNCgkJaWRfdmlkZW8gPSBsaW5rc1s1XQ0KCQl0ZW1wb3JhZGEgPSBsaW5rc1s3XQ0KCQllcGlzb2RpbyA9IGxpbmtzWy0xXQ0KCQl0aXBvID0gMQ0KCWVsaWYgJ2FuaW1lJyBpbiB1cmw6DQoJCWlkX3ZpZGVvID0gbGlua3NbNV0NCgkJdGVtcG9yYWRhID0gbGlua3NbN10NCgkJZXBpc29kaW8gPSBsaW5rc1stMV0NCgkJdGlwbyA9IDINCg0KCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzKQ0KCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoNCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gYWRkb24uJykNCgkJcmV0dXJuIEZhbHNlDQoJDQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pDQoNCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYShyZXN1bHRhZG8pDQoNCglmb2xkZXIgPSB4Ym1jLnRyYW5zbGF0ZVBhdGgoX19BRERPTl9fLmdldFNldHRpbmcoJ3Bhc3RhRG93bmxvYWRzJykpDQoJaWYoZm9sZGVyID09ICdFc2NvbGhhIGEgcGFzdGEgcGFyYSBEb3dubG9hZCcpOg0KCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdTZWxlY2Npb25lIHVtYSBwYXN0YSBwcmltZWlybyBubyBzdWJtZW51IENyZWTDqm5jaWFpcyBvdSBuYXMgQ29uZmlndXJhw6fDtWVzIGRvIEFkZG9uLicpDQoJZWxzZToNCgkJaWYgdGlwbyA+IDA6DQoJCQlpZiB0aXBvID09IDE6DQoJCQkJcmVzdWx0YWRvYSA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ3NlcmllLycraWRfdmlkZW8sIGhlYWRlcj1oZWFkZXJzKQ0KCQkJZWxpZiB0aXBvID09IDI6DQoJCQkJcmVzdWx0YWRvYSA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2FuaW1lLycraWRfdmlkZW8sIGhlYWRlcj1oZWFkZXJzKQ0KCQkJcmVzdWx0YWRvYSA9IGpzb24ubG9hZHMocmVzdWx0YWRvYSkNCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnKSk6DQoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJykpDQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddKSk6DQoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddKSkNCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sIlRlbXBvcmFkYSAiK3N0cih0ZW1wb3JhZGEpKSk6DQoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddLCJUZW1wb3JhZGEgIitzdHIodGVtcG9yYWRhKSkpDQoJCQlmb2xkZXIgPSBvcy5wYXRoLmpvaW4oZm9sZGVyLCAnc2VyaWVzJywgcmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSwgIlRlbXBvcmFkYSIsIHN0cih0ZW1wb3JhZGEpKQ0KCQkJbmFtZSA9ICJlIitzdHIoZXBpc29kaW8pKyIgLSAiK2NsZWFuKHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddKQ0KCQllbHNlOg0KCQkJaWYgbm90IHhibWN2ZnMuZXhpc3RzKG9zLnBhdGguam9pbihmb2xkZXIsJ2ZpbG1lcycpKToNCgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKSkNCgkJCWZvbGRlciA9IG9zLnBhdGguam9pbihmb2xkZXIsJ2ZpbG1lcycpDQoJCQluYW1lID0gcmVzdWx0YWRvWydub21lX2luZ2xlcyddDQoNCgkJc3RyZWFtQXV4ID0gY2xlYW4oc3RyZWFtLnNwbGl0KCcvJylbLTFdKQ0KCQlleHRlbnNhb1N0cmVhbSA9IGNsZWFuKHN0cmVhbUF1eC5zcGxpdCgnLicpWy0xXSkNCg0KCQlpZiAnP21pbScgaW4gZXh0ZW5zYW9TdHJlYW06DQoJCQlleHRlbnNhb1N0cmVhbSA9IHJlLmNvbXBpbGUoJyguKz8pXD9taW1lPScpLmZpbmRhbGwoZXh0ZW5zYW9TdHJlYW0pWzBdDQoNCgkJaWYgZXh0X2cgIT0gJ2NvaXNvJzoNCgkJCWV4dGVuc2FvU3RyZWFtID0gZXh0X2cNCg0KCQlub21lU3RyZWFtID0gbmFtZSsnLicrZXh0ZW5zYW9TdHJlYW0NCgkJbm9tZWxlZ2VuZGEgPSAnJw0KCQlEb3dubG9hZGVyLkRvd25sb2FkZXIoKS5kb3dubG9hZChvcy5wYXRoLmpvaW4oZm9sZGVyLmRlY29kZSgidXRmLTgiKSwgbm9tZVN0cmVhbSksIHN0cmVhbSwgbmFtZSkNCgkJDQoJCWlmIGxlZ2VuZGFzT246DQoJCQlsZWdlbmRhQXV4ID0gY2xlYW4obGVnZW5kYS5zcGxpdCgnLycpWy0xXSkNCgkJCWV4dGVuc2FvTGVnZW5kYSA9IGNsZWFuKGxlZ2VuZGFBdXguc3BsaXQoJy4nKVsxXSkNCgkJCW5vbWVMZWdlbmRhID0gbmFtZSsnLicrZXh0ZW5zYW9MZWdlbmRhDQoJCQlkb3dubG9hZF9sZWdlbmRhcyhsZWdlbmRhLCBvcy5wYXRoLmpvaW4oZm9sZGVyLCBub21lTGVnZW5kYSkpDQoNCmRlZiBkb3dubG9hZF9sZWdlbmRhcyh1cmwscGF0aCk6DQoJY29udGVudHMgPSBhYnJpcl91cmwodXJsKQ0KCWlmIGNvbnRlbnRzOg0KCQlmaCA9IG9wZW4ocGF0aCwgJ3cnKQ0KCQlmaC53cml0ZShjb250ZW50cykNCgkJZmguY2xvc2UoKQ0KCXJldHVybg0KDQpkZWYgY2xlYW4odGV4dCk6DQoJY29tbWFuZD17JyYjODIyMDsnOiciJywnJiM4MjIxOyc6JyInLCAnJiM4MjExOyc6Jy0nLCcmYW1wOyc6JyYnLCcmIzgyMTc7JzoiJyIsJyYjODIxNjsnOiInIn0NCglyZWdleCA9IHJlLmNvbXBpbGUoInwiLmpvaW4obWFwKHJlLmVzY2FwZSwgY29tbWFuZC5rZXlzKCkpKSkNCglyZXR1cm4gcmVnZXguc3ViKGxhbWJkYSBtbzogY29tbWFuZFttby5ncm91cCgwKV0sIHRleHQpDQoNCmRlZiBhZGRWaWRlbyhuYW1lLHVybCxtb2RlLGljb25pbWFnZSx2aXN0byx0aXBvLHRlbXBvcmFkYSxlcGlzb2RpbyxpbmZvTGFiZWxzLHBvc3Rlcix0cmFpbGVyPUZhbHNlLHNlcmllTm9tZT1GYWxzZSk6DQoJbWVudSA9IFtdDQoJDQoJaWYgaW5mb0xhYmVsczogaW5mb0xhYmVsc0F1eCA9IGluZm9MYWJlbHMNCgllbHNlOiBpbmZvTGFiZWxzQXV4ID0geydUaXRsZSc6IG5hbWV9DQoNCglpZiBwb3N0ZXI6IHBvc3RlckF1eCA9IHBvc3Rlcg0KCWVsc2U6IHBvc3RlckF1eCA9IGljb25pbWFnZQ0KCQ0KCXRyeToNCgkJbmFtZSA9IG5hbWUuZW5jb2RlKCd1dGYtOCcpDQoJZXhjZXB0Og0KCQluYW1lID0gbmFtZQ0KCQ0KCXRyeToNCgkJc2VyaWVOb21lID0gc2VyaWVOb21lLmVuY29kZSgndXRmLTgnKQ0KCWV4Y2VwdDoNCgkJc2VyaWVOb21lID0gc2VyaWVOb21lDQoJZWxzZToNCgkJcGFzcw0KDQoJZmFuYXJ0ID0gX19GQU5BUlRfXw0KCQ0KCWlmIHRpcG8gPT0gJ2ZpbG1lJzoNCgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQ0KCQlpZiBfX0FERE9OX18uZ2V0U2V0dGluZygndHJhaWxlci1maWxtZXMnKSA9PSAndHJ1ZSc6DQoJCQl0cnk6DQoJCQkJaWRZb3V0dWJlID0gdHJhaWxlci5zcGxpdCgnP3Y9JylbLTFdLnNwbGl0KCcvJylbLTFdLnNwbGl0KCc/JylbMF0uc3BsaXQoJyYnKVswXQ0KCQkJCWxpbmtUcmFpbGVyID0gJ3BsdWdpbjovL3BsdWdpbi52aWRlby55b3V0dWJlL3BsYXkvP3ZpZGVvX2lkPScraWRZb3V0dWJlDQoJCQkJI2lkWW91dHViZT10cmFpbGVyLnNwbGl0KCc9JykNCgkJCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSUQ6ICcraWRZb3V0dWJlWzFdKQ0KCQkJCSNsaW5rVHJhaWxlciA9ICdwbHVnaW46Ly9wbHVnaW4udmlkZW8ueW91dHViZS8/cGF0aD0vcm9vdC92aWRlbyZhY3Rpb249cGxheV92aWRlbyZ2aWRlb2lkPScraWRZb3V0dWJlWzFdDQoJCQkJI2xpbmtUcmFpbGVyID0gdHJhaWxlcg0KCQkJZXhjZXB0Og0KCQkJCWxpbmtUcmFpbGVyID0gJycNCgkJZWxzZToNCgkJCWxpbmtUcmFpbGVyID0gJycNCgllbGlmIHRpcG8gPT0gJ3NlcmllJzoNCgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICd0dnNob3dzJykNCgkJaWRJTURiID0gcmUuY29tcGlsZSgnaW1kYj0oLis/KSYnKS5maW5kYWxsKHVybClbMF0NCgkJbGlua1RyYWlsZXIgPSAiIg0KCWVsaWYgdGlwbyA9PSAnZXBpc29kaW8nOg0KCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ2VwaXNvZGVzJykNCgkJbGlua1RyYWlsZXIgPSAiIg0KCWVsc2U6DQoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykNCgkJbGlua1RyYWlsZXIgPSAiIg0KCQ0KCW92ZXJsYXkgPSA2DQoJcGxheWNvdW50ID0gMA0KDQoJaW5mb0xhYmVsc0F1eFsib3ZlcmxheSJdID0gb3ZlcmxheQ0KCWluZm9MYWJlbHNBdXhbInBsYXljb3VudCJdID0gcGxheWNvdW50DQoJDQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQ0KCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb0xhYmVsc0F1eCkNCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIHBvc3RlcikNCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogcG9zdGVyfSkNCgkNCgkNCglpZiBub3Qgc2VyaWVOb21lOg0KCQlzZXJpZU5vbWUgPSAnJw0KDQoJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImdGVtcG9yYWRhPSIrc3RyKHRlbXBvcmFkYSkrIiZlcGlzb2Rpbz0iK3N0cihlcGlzb2RpbykrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZpY29uaW1hZ2U9Iit1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKyImc2VyaWVOb21lPSIrdXJsbGliLnF1b3RlX3BsdXMoc2VyaWVOb21lKQ0KCW9rPVRydWUNCgkNCglpZiBsaW5rVHJhaWxlciAhPSAiIjoNCgkJbWVudS5hcHBlbmQoKCdWZXIgVHJhaWxlcicsICdYQk1DLlBsYXlNZWRpYSglcyknICUgKGxpbmtUcmFpbGVyKSkpDQoJCSNtZW51LmFwcGVuZCgoJ1ZlciBUcmFpbGVyJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MTA1Jm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyknJShzeXMuYXJndlswXSx1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSwgbGlua1RyYWlsZXIsIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSkpKSkNCgkNCgltZW51LmFwcGVuZCgoJ0Rvd25sb2FkJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MTE3Jm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyZzZXJpZU5vbWU9JXMmdGVtcG9yYWRhPSVzJmVwaXNvZGlvPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpLCB1cmxsaWIucXVvdGVfcGx1cyhzZXJpZU5vbWUpLCBzdHIodGVtcG9yYWRhKSwgc3RyKGVwaXNvZGlvKSkpKQ0KCWxpei5hZGRDb250ZXh0TWVudUl0ZW1zKG1lbnUsIHJlcGxhY2VJdGVtcz1UcnVlKQ0KCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9RmFsc2UpDQoJcmV0dXJuIG9rDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojCQkJCQkJCQlGVU5DT0VTIEpBIEZFSVRBUwkJCQkJCQkJICMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQpkZWYgYWJyaXJOYWRhKCk6DQoJeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpDQoJDQpkZWYgYWRkRGlyKG5hbWUsdXJsLG1vZGUsZXN0aWxvLGljb25pbWFnZSx0aXBvLGZhbmFydCxwYXN0YT1UcnVlLHRvdGFsPTEpOg0KCWlmKHRpcG8gPT0gJ2xpbXBhcmNhY2hlJyBhbmQgdGlwbyA9PSAnbGltcGFydHVkbycpOgkJCQkNCgkJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpDQoJZWxzZToNCgkJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpKyImZXN0aWxvPSIrdXJsbGliLnF1b3RlX3BsdXMoZXN0aWxvKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpDQoJb2s9VHJ1ZQ0KCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkNCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIGZhbmFydCkNCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogZmFuYXJ0fSkNCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPXBhc3RhLHRvdGFsSXRlbXM9dG90YWwpDQoJcmV0dXJuIG9rDQoNCmRlZiBhZGREaXIyKG5hbWUsdXJsLG1vZGUsbW9kZTIsaWNvbmltYWdlLHBhZ2luYT0xLHRpcG89Tm9uZSxpbmZvTGFiZWxzPU5vbmUscG9zdGVyPU5vbmUsdmlzdG89RmFsc2UpOg0KCWlmIGluZm9MYWJlbHM6IGluZm9MYWJlbHNBdXggPSBpbmZvTGFiZWxzDQoJZWxzZTogaW5mb0xhYmVsc0F1eCA9IHsnVGl0bGUnOiBuYW1lfQ0KCWZhbmFydCA9ICcnDQoJaWYgcG9zdGVyOiBmYW5hcnQgPSBwb3N0ZXINCgllbHNlOiBmYW5hcnQgPSBpY29uaW1hZ2UNCgkNCgl0cnk6DQoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQ0KCWV4Y2VwdDoNCgkJbmFtZSA9IG5hbWUNCg0KCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kbz0iK21vZGUyKyImbW9kZT0iK3N0cihtb2RlKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKQ0KCQ0KCW9rPVRydWUNCg0KCSNmYW5hcnQgPSBfX0ZBTkFSVF9fDQoNCglpZiB0aXBvID09ICdmaWxtZSc6DQoJCSNmYW5hcnQgPSBwb3N0ZXJBdXgNCgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQ0KCWVsaWYgdGlwbyA9PSAnc2VyaWUnOg0KCQkjZmFuYXJ0ID0gcG9zdGVyQXV4DQoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpDQoJZWxpZiB0aXBvID09ICdlcGlzb2Rpbyc6DQoJCSNmYW5hcnQgPSBwb3N0ZXJBdXgNCgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdlcGlzb2RlcycpDQoJZWxzZToNCgkJaWYgbmFtZSAhPSAnUmVmcmVzaCc6DQoJCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpDQoJDQoJb3ZlcmxheSA9IDYNCglwbGF5Y291bnQgPSAwDQoJDQoJaW5mb0xhYmVsc0F1eFsib3ZlcmxheSJdID0gb3ZlcmxheQ0KCWluZm9MYWJlbHNBdXhbInBsYXljb3VudCJdID0gcGxheWNvdW50DQoJDQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQ0KCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQ0KCWxpei5zZXRBcnQoeydmYW5hcnQnOiBmYW5hcnR9KQ0KCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb0xhYmVsc0F1eCApDQoNCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPVRydWUpDQoJcmV0dXJuIG9rDQoNCmRlZiBhZGRMaW5rQ2FuYWwobmFtZSx1cmwsaWNvbmltYWdlLGlkY2FuYWwsaWRfcCk6DQoJaW5mb0xhYmVsc3NzcyA9IHsidGl0bGUiOiBuYW1lLCAiZ2VucmUiOiAnQWxsJ30NCglvaz1UcnVlDQoJY209W10NCgkNCglsaXogPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkNCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNzc3MpDQoJbGl6LmFkZENvbnRleHRNZW51SXRlbXMoY20sIHJlcGxhY2VJdGVtcz1GYWxzZSkNCglsaXouc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpDQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpDQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKX0pDQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHVybGxpYi5xdW90ZV9wbHVzKHVybCkgKyAiJm1vZGU9MTEmbmFtZT0iICsgdXJsbGliLnF1b3RlX3BsdXMobmFtZSkgKyAiJmljb25pbWFnZT0iICsgdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSsiJnN0cmVhbV9pZD0iK3N0cihpZGNhbmFsKQ0KCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSwgdXJsPXUsIGxpc3RpdGVtPWxpeikNCglyZXR1cm4gb2sNCgkNCmRlZiBhYnJpcl91cmwodXJsLCBwb3N0PU5vbmUsIGhlYWRlcj1Ob25lLCBjb2RlPUZhbHNlLCBlcnJvPUZhbHNlKToNCglpZiBoZWFkZXIgPT0gTm9uZToNCgkJaGVhZGVyID0gaGVhZGVycw0KCWlmIHBvc3Q6DQoJCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsIGRhdGE9cG9zdCwgaGVhZGVycz1oZWFkZXIpDQoJZWxzZToNCgkJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgaGVhZGVycz1oZWFkZXIpDQoJdHJ5Og0KCQlyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpDQoJZXhjZXB0IHVybGxpYjIuSFRUUEVycm9yIGFzIHJlc3BvbnNlOg0KCQlpZiBlcnJvID09IFRydWU6DQoJCQlyZXR1cm4gc3RyKHJlc3BvbnNlLmNvZGUpLCAiYXNkIg0KCWxpbms9cmVzcG9uc2UucmVhZCgpDQoJDQoJaWYgJ2p1ZGljaWFsIGJsYmxibGJsYmwnIGluIGxpbms6DQoJCXJldHVybiAnRE5TJw0KCWlmIGNvZGU6DQoJCXJldHVybiBzdHIocmVzcG9uc2UuY29kZSksIGxpbmsNCg0KCXJlc3BvbnNlLmNsb3NlKCkNCglyZXR1cm4gbGluaw0KDQpkZWYgYWRkTGluazIobmFtZSx1cmwsaWNvbmltYWdlKToNCglvaz1UcnVlDQoJbGl6ID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpDQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBpY29uaW1hZ2UpDQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGljb25pbWFnZX0pDQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUgfSkNCglsaXouc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpDQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHVybCArICImbW9kZT0xMDYmbmFtZT0iICsgbmFtZSArICImaWNvbmltYWdlPSIgKyBpY29uaW1hZ2UNCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksIHVybD11LCBsaXN0aXRlbT1saXopDQoJcmV0dXJuIG9rDQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMJCQkJCQkJICBERUZJTklOQ09FUwkJCQkJCQkJCQkgICMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCQ0KDQpkZWYgdmlzdGFfR3J1cG9zKCk6DQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnY2FuYWlzVmlldycpDQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikNCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpDQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikNCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpDQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikNCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQ0KCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpDQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQ0KDQpkZWYgdmlzdGFfQ2FuYWlzKCk6DQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnY2FuYWlzVmlldzInKQ0KCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpDQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpDQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikNCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQ0KCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpDQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikNCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikNCg0KZGVmIHZpc3RhX21lbnUoKToNCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtZW51VmlldycpDQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikNCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpDQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikNCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpDQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikNCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQ0KCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpDQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQ0KDQpkZWYgdmlzdGFfZmlsbWVzU2VyaWVzKCk6DQoJeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpDQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnZmlsbWVzU2VyaWVzVmlldycpDQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikNCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpDQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikNCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpDQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikNCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQ0KCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpDQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQ0KDQoNCmRlZiB2aXN0YV90ZW1wb3JhZGFzKCk6DQoJeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpDQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygndGVtcG9yYWRhc1ZpZXcnKQ0KCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpDQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpDQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikNCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQ0KCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpDQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikNCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikNCg0KZGVmIHZpc3RhX2VwaXNvZGlvcygpOg0KCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQ0KCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2VwaXNvZGlvc1ZpZXcnKQ0KCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpDQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpDQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikNCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQ0KCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpDQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikNCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQ0KCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIwkJCQkJCQkJCQkJCUdFVCBQQVJBTVMJCQkJCQkJCQkJCQkgIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCQkgIA0KZGVmIGdldF9wYXJhbXMoKToNCglwYXJhbT1bXQ0KCXBhcmFtc3RyaW5nPXN5cy5hcmd2WzJdDQoJaWYgbGVuKHBhcmFtc3RyaW5nKT49MjoNCgkJcGFyYW1zPXN5cy5hcmd2WzJdDQoJCWNsZWFuZWRwYXJhbXM9cGFyYW1zLnJlcGxhY2UoJz8nLCcnKQ0KCQlpZiAocGFyYW1zW2xlbihwYXJhbXMpLTFdPT0nLycpOiBwYXJhbXM9cGFyYW1zWzA6bGVuKHBhcmFtcyktMl0NCgkJcGFpcnNvZnBhcmFtcz1jbGVhbmVkcGFyYW1zLnNwbGl0KCcmJykNCgkJcGFyYW09e30NCgkJZm9yIGkgaW4gcmFuZ2UobGVuKHBhaXJzb2ZwYXJhbXMpKToNCgkJCXNwbGl0cGFyYW1zPXt9DQoJCQlzcGxpdHBhcmFtcz1wYWlyc29mcGFyYW1zW2ldLnNwbGl0KCc9JykNCgkJCWlmIChsZW4oc3BsaXRwYXJhbXMpKT09MjogcGFyYW1bc3BsaXRwYXJhbXNbMF1dPXNwbGl0cGFyYW1zWzFdDQoJcmV0dXJuIHBhcmFtDQoNCg0KcGFyYW1zPWdldF9wYXJhbXMoKQ0KdXJsPU5vbmUNCmJ1aWxkdGlwbz1Ob25lDQpuYW1lPU5vbmUNCm1vZGU9Tm9uZQ0KaWNvbmltYWdlPU5vbmUNCmxpbms9Tm9uZQ0Kc2VuaGE9Tm9uZQ0KZXN0aWxvPU5vbmUNCnNydGZpbG09Tm9uZQ0KaWRDYW5hbD1Ob25lDQppZGZmQ2FuYWw9Tm9uZQ0KdGlwb2xvZ2lhPU5vbmUNCmRlc2NyaWNhbz1Ob25lDQp0aXBvX3VzZXI9Tm9uZQ0Kc2Vydmlkb3JfdXNlcj1Ob25lDQpkYXRhX3VzZXI9Tm9uZQ0Kc19zZXJ2PU5vbmUNCnNfdXNlcj1Ob25lDQpzX3Bhc3M9Tm9uZQ0KbGVnZW5kYT1Ob25lDQpwYWdpbmE9Tm9uZQ0KdGVtcG9yYWRhPU5vbmUNCmVwaXNvZGlvPU5vbmUNCnNlcmllTm9tZT1Ob25lDQpmYW5hcnQ9Tm9uZQ0KdGh1bWJuYWlsPU5vbmUNCnN0cmVhbV9pZD1Ob25lDQpkdXJhdGlvbj1Ob25lDQp0aXBvc2VsZWN0PU5vbmUNCg0KdHJ5OiBkdXJhdGlvbj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZHVyYXRpb24iXSkNCmV4Y2VwdDogcGFzcw0KdHJ5OiBzdHJlYW1faWQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInN0cmVhbV9pZCJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IHVybD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidXJsIl0pDQpleGNlcHQ6IHBhc3MNCnRyeTogbmFtZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibmFtZSJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IGVzdGlsbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZXN0aWxvIl0pDQpleGNlcHQ6IHBhc3MNCnRyeTogbW9kZT1pbnQocGFyYW1zWyJtb2RlIl0pDQpleGNlcHQ6IHBhc3MNCnRyeTogaWNvbmltYWdlPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpY29uaW1hZ2UiXSkNCmV4Y2VwdDogcGFzcw0KdHJ5OiBzZW5oYT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2VuaGEiXSkNCmV4Y2VwdDogcGFzcw0KdHJ5OiBpZENhbmFsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpZENhbmFsIl0pDQpleGNlcHQ6IHBhc3MNCnRyeTogaWRmZkNhbmFsPXBhcmFtc1siaWRmZkNhbmFsIl0NCmV4Y2VwdDogcGFzcw0KdHJ5OiBzcnRmaWxtPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzcnRmaWxtIl0pDQpleGNlcHQ6IHBhc3MNCnRyeTogdGlwb2xvZ2lhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvbG9naWEiXSkNCmV4Y2VwdDogcGFzcw0KdHJ5OiBkZXNjcmljYW89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImRlc2NyaWNhbyJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IHRpcG9fdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidGlwb191c2VyIl0pDQpleGNlcHQ6IHBhc3MNCnRyeTogc2Vydmlkb3JfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2Vydmlkb3JfdXNlciJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IHNfc2Vydj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9sc2VydiJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IHNfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9sdXNlciJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IHNfcGFzcz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9scGFzcyJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IGxpbms9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxpbmsiXSkNCmV4Y2VwdDogcGFzcw0KdHJ5OiBsZWdlbmRhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsZWdlbmRhIl0pDQpleGNlcHQ6IHBhc3MNCnRyeTogbmFtZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibmFtZSJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IHRlbXBvcmFkYT1pbnQocGFyYW1zWyJ0ZW1wb3JhZGEiXSkNCmV4Y2VwdDogcGFzcw0KdHJ5OiBlcGlzb2Rpbz1pbnQocGFyYW1zWyJlcGlzb2RpbyJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IG1vZGU9aW50KHBhcmFtc1sibW9kZSJdKQ0KZXhjZXB0OiBwYXNzDQp0cnk6IHBhZ2luYT1pbnQocGFyYW1zWyJwYWdpbmEiXSkNCmV4Y2VwdDogcGFzcw0KdHJ5OiBpY29uaW1hZ2U9cGFyYW1zWyJpY29uaW1hZ2UiXQ0KZXhjZXB0OiBwYXNzDQp0cnkgOiBzZXJpZU5vbWU9cGFyYW1zWyJzZXJpZU5vbWUiXQ0KZXhjZXB0OiBwYXNzDQp0cnkgOiBidWlsZHRpcG89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImJ1aWxkdGlwbyJdKQ0KZXhjZXB0OiBwYXNzDQp0cnkgOiBmYW5hcnQ9cGFyYW1zWyJmYW5hcnQiXQ0KZXhjZXB0OiBwYXNzDQp0cnkgOiB0aHVtYm5haWw9cGFyYW1zWyJ0aHVtYm5haWwiXQ0KZXhjZXB0OiBwYXNzDQp0cnkgOiBkYXRhX3VzZXI9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImRhdGFfdXNlciJdKQ0KZXhjZXB0OiBwYXNzDQp0cnkgOiB0aXBvc2VsZWN0PXBhcmFtc1sidGlwb3NlbGVjdCJdDQpleGNlcHQ6IHBhc3MNCg0KDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIwkJCQkJCQkJCQkJCQlNT0RPUwkJCQkJCQkJCQkJCQkgIw0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQppZiBtb2RlPT1Ob25lIG9yIHVybD09Tm9uZSBvciBsZW4odXJsKTwxOiBtZW51KCkNCmVsaWYgbW9kZT09MTogYWJyaXJWaWRlb0NsdWJlKHN0cih1cmwpKQ0KZWxpZiBtb2RlPT0yOiBBYnJpcl9Db250YShzdHIodXJsKSkNCmVsaWYgbW9kZT09MzogYWJyaW0zdShzdHIodXJsKSkNCmVsaWYgbW9kZT09NDogZGV0ZWN0X21vZGlmaWNhdGlvbihzdHIodXJsKSkNCmVsaWYgbW9kZT09NTogYWJyaXJEZWZpbmluY29lcygpDQplbGlmIG1vZGU9PTY6IGxpc3RhdHZhcmNoaXZlKHN0cih1cmwpKQ0KZWxpZiBtb2RlPT03OiBsaXN0YXR2YXJjaGl2ZWNhbmFpcyhzdHIobmFtZSksc3RyZWFtX2lkLHN0cih1cmwpLGR1cmF0aW9uLGljb25pbWFnZSxmYW5hcnQpDQplbGlmIG1vZGU9PTg6IHN0cmVhbV92aWRlbyhuYW1lLHVybCxpY29uaW1hZ2UpDQplbGlmIG1vZGU9PTk6IGdldF9teWFjY291bnQobmFtZSx1cmwsaWNvbmltYWdlKQ0KZWxpZiBtb2RlPT0xMDogcnVuX2Nyb25qb2IobmFtZSx1cmwsaWNvbmltYWdlLHRodW1ibmFpbCxmYW5hcnQpDQplbGlmIG1vZGU9PTExOiBQbGF5VXJsKG5hbWUsdXJsLGljb25pbWFnZSkNCmVsaWYgbW9kZT09MTM6IENMRUFSQ0FDSEUoKQ0KZWxpZiBtb2RlPT0xNDogUFVSR0VQQUNLQUdFUygpDQplbGlmIG1vZGU9PTIwOiBsaXN0YW1lbnVzc2VyaWVzKHN0cihuYW1lKSxzdHIodXJsKSxpY29uaW1hZ2UsZmFuYXJ0KQ0KZWxpZiBtb2RlPT0yMTogbGlzdGFtZW51c2ZpbG1lcyhzdHIobmFtZSksc3RyKHVybCksaWNvbmltYWdlLGZhbmFydCkNCmVsaWYgbW9kZT09MjQ6IGxpc3RhbWVudXNhbmltZXMoc3RyKG5hbWUpLHN0cih1cmwpLGljb25pbWFnZSxmYW5hcnQpDQplbGlmIG1vZGU9PTExMTogZmlsbWVzKHVybCwgcGFnaW5hKQ0KZWxpZiBtb2RlPT0xMjM6IHNlcmllcyh1cmwpDQplbGlmIG1vZGU9PTExODogZ2V0R2VuZXJvcyh1cmwpDQplbGlmIG1vZGU9PTExOTogZ2V0WWVhcnModXJsKQ0KZWxpZiBtb2RlPT0xMjA6IHBlc3F1aXNhKHVybCkNCmVsaWYgbW9kZT09MTIxOiBhbm9zKHVybCkNCmVsaWYgbW9kZT09MTIyOiBjYXRlZ29yaWFzKHVybCkNCmVsaWYgbW9kZT09MTEzOiBwbGF5ZXIobmFtZSwgdXJsLCBpY29uaW1hZ2UsIHRlbXBvcmFkYSwgZXBpc29kaW8sIHNlcmllTm9tZSkNCmVsaWYgbW9kZT09MTE0OiBnZXRTZWFzb25zKHVybCkNCmVsaWYgbW9kZT09MTE1OiBnZXRFcGlzb2Rlcyh1cmwpDQplbGlmIG1vZGU9PTExNzogZG93bmxvYWQodXJsLCBuYW1lLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCBzZXJpZU5vbWUpDQoNCmlmIG1vZGU9PU5vbmUgb3IgdXJsPT1Ob25lIG9yIGxlbih1cmwpPDE6DQoJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQ0KZWxzZToNCglpZiBtb2RlICE9MyBhbmQgbW9kZSAhPTYgYW5kIG1vZGUgIT03OiANCgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQ0KCWVsc2U6IA0KCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9VHJ1ZSk="))